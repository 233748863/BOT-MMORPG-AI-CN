"""
MMORPGæ¸¸æˆAIåŠ©æ‰‹ - ä¸»å¯åŠ¨å™¨
ä¸­æ–‡æ±‰åŒ–ç‰ˆ

åŠŸèƒ½:
- ä¸»çº¿ä»»åŠ¡è‡ªåŠ¨åŒ–
- è‡ªåŠ¨æˆ˜æ–—è®­ç»ƒ
- å¢å¼ºæ¨¡å¼ (YOLOæ£€æµ‹ + çŠ¶æ€è¯†åˆ« + æ™ºèƒ½å†³ç­–)
"""

import os
import sys

# è®¾ç½®å·¥ä½œç›®å½•
os.chdir(os.path.dirname(os.path.abspath(__file__)))

# æ·»åŠ é¡¹ç›®è·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))


def æ˜¾ç¤ºä¸»èœå•():
    """æ˜¾ç¤ºä¸»èœå•"""
    print()
    print("=" * 60)
    print("ğŸ® MMORPGæ¸¸æˆAIåŠ©æ‰‹ - ä¸­æ–‡ç‰ˆ")
    print("=" * 60)
    print()
    print("ğŸ“‹ è¯·é€‰æ‹©åŠŸèƒ½:")
    print("  1. ğŸ¥ æ•°æ®æ”¶é›† (å½•åˆ¶æ¸¸æˆæ“ä½œ)")
    print("  2. ğŸ§  è®­ç»ƒæ¨¡å‹ (è®­ç»ƒAIå¤§è„‘)")
    print("  3. ğŸ¤– è¿è¡Œæœºå™¨äºº (åŸºç¡€æ¨¡å¼)")
    print("  4. ğŸš€ è¿è¡Œå¢å¼ºæœºå™¨äºº (æ™ºèƒ½æ¨¡å¼)")
    print("  5. ğŸ”§ æ•°æ®å·¥å…· (é¢„å¤„ç†/æ¸…æ´—/æƒé‡)")
    print("  6. âš™ï¸  å¢å¼ºæ¨¡å—é…ç½®")
    print("  7. â“ æŸ¥çœ‹å¸®åŠ©")
    print("  8. ğŸ–¥ï¸  å¯åŠ¨å›¾å½¢ç•Œé¢ (GUI)")
    print("  0. ğŸšª é€€å‡ºç¨‹åº")
    print()


def æ˜¾ç¤ºå¸®åŠ©():
    """æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯"""
    print()
    print("=" * 60)
    print("ğŸ“– ä½¿ç”¨å¸®åŠ©")
    print("=" * 60)
    print()
    print("ã€å¿«é€Ÿå¼€å§‹ã€‘")
    print()
    print("1ï¸âƒ£  æ•°æ®æ”¶é›†:")
    print("   - è¿è¡Œæ•°æ®æ”¶é›†åŠŸèƒ½")
    print("   - åˆ‡æ¢åˆ°æ¸¸æˆçª—å£")
    print("   - æ­£å¸¸ç©æ¸¸æˆï¼ŒAIä¼šè®°å½•ä½ çš„æ“ä½œ")
    print("   - æŒ‰ T æš‚åœ/ç»§ç»­ï¼ŒæŒ‰ Q é€€å‡º")
    print()
    print("2ï¸âƒ£  è®­ç»ƒæ¨¡å‹:")
    print("   - æ”¶é›†è¶³å¤Ÿæ•°æ®åè¿è¡Œè®­ç»ƒ")
    print("   - å»ºè®®è‡³å°‘æ”¶é›†10ä¸ªæ•°æ®æ–‡ä»¶")
    print("   - è®­ç»ƒæ—¶é—´å–å†³äºæ•°æ®é‡å’Œç¡¬ä»¶")
    print()
    print("3ï¸âƒ£  è¿è¡Œæœºå™¨äºº:")
    print("   - åŸºç¡€æ¨¡å¼: ä½¿ç”¨æ¨¡ä»¿å­¦ä¹ æ¨¡å‹")
    print("   - å¢å¼ºæ¨¡å¼: é›†æˆYOLOæ£€æµ‹+çŠ¶æ€è¯†åˆ«+æ™ºèƒ½å†³ç­–")
    print("   - æŒ‰ T æš‚åœ/ç»§ç»­ï¼ŒæŒ‰ ESC é€€å‡º")
    print()
    print("ã€è¿è¡Œæ¨¡å¼è¯´æ˜ã€‘")
    print()
    print("ğŸ¤– åŸºç¡€æ¨¡å¼:")
    print("   ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡ä»¿å­¦ä¹ æ¨¡å‹")
    print("   é€‚åˆå·²æœ‰è®­ç»ƒæ•°æ®çš„ç”¨æˆ·")
    print()
    print("ğŸš€ å¢å¼ºæ¨¡å¼:")
    print("   - YOLOç›®æ ‡æ£€æµ‹: è¯†åˆ«æ€ªç‰©ã€NPCã€ç‰©å“ç­‰")
    print("   - çŠ¶æ€è¯†åˆ«: åˆ¤æ–­æˆ˜æ–—ã€å¯¹è¯ã€èœå•ç­‰çŠ¶æ€")
    print("   - æ™ºèƒ½å†³ç­–: ç»“åˆè§„åˆ™å’Œæ¨¡å‹åšå‡ºå†³ç­–")
    print("   - è‡ªåŠ¨é™çº§: æ¨¡å—å¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°åŸºç¡€æ¨¡å¼")
    print()
    print("ã€è®­ç»ƒæ¨¡å¼è¯´æ˜ã€‘")
    print()
    print("ğŸ¯ ä¸»çº¿ä»»åŠ¡æ¨¡å¼:")
    print("   ä¸“æ³¨äºå­¦ä¹ åšä¸»çº¿ä»»åŠ¡çš„æ“ä½œ")
    print("   åŒ…æ‹¬: NPCå¯¹è¯ã€ä»»åŠ¡å¯»è·¯ã€ç‰©å“æ‹¾å–ç­‰")
    print()
    print("âš”ï¸  è‡ªåŠ¨æˆ˜æ–—æ¨¡å¼:")
    print("   ä¸“æ³¨äºå­¦ä¹ æˆ˜æ–—æŠ€èƒ½é‡Šæ”¾")
    print("   åŒ…æ‹¬: æŠ€èƒ½é‡Šæ”¾ã€èµ°ä½èº²é¿ã€ç›®æ ‡é€‰æ‹©ç­‰")
    print()
    print("ã€ç³»ç»Ÿè¦æ±‚ã€‘")
    print()
    print("   - Windows 10/11")
    print("   - Python 3.8+")
    print("   - 8GB+ å†…å­˜")
    print("   - NVIDIA GPU (æ¨èï¼ŒCPUä¹Ÿå¯è¿è¡Œ)")
    print("   - ultralyticsåº“ (å¢å¼ºæ¨¡å¼éœ€è¦)")
    print()
    input("æŒ‰å›è½¦é”®è¿”å›ä¸»èœå•...")


def è¿è¡Œæ•°æ®æ”¶é›†():
    """è¿è¡Œæ•°æ®æ”¶é›†è„šæœ¬"""
    print("\nğŸ¥ å¯åŠ¨æ•°æ®æ”¶é›†...")
    from è®­ç»ƒ.æ”¶é›†æ•°æ® import ä¸»ç¨‹åº
    ä¸»ç¨‹åº()


def è¿è¡Œè®­ç»ƒæ¨¡å‹():
    """è¿è¡Œæ¨¡å‹è®­ç»ƒè„šæœ¬"""
    print("\nğŸ§  å¯åŠ¨æ¨¡å‹è®­ç»ƒ...")
    from è®­ç»ƒ.è®­ç»ƒæ¨¡å‹ import ä¸»ç¨‹åº
    ä¸»ç¨‹åº()


def è¿è¡Œæœºå™¨äºº():
    """è¿è¡ŒåŸºç¡€æ¸¸æˆæœºå™¨äºº"""
    print("\nğŸ¤– å¯åŠ¨åŸºç¡€æ¸¸æˆæœºå™¨äºº...")
    from è¿è¡Œ.è¿è¡Œæœºå™¨äºº import ä¸»ç¨‹åº
    ä¸»ç¨‹åº()


def è¿è¡Œå¢å¼ºæœºå™¨äºº():
    """è¿è¡Œå¢å¼ºç‰ˆæ¸¸æˆæœºå™¨äºº"""
    print("\nğŸš€ å¯åŠ¨å¢å¼ºç‰ˆæ¸¸æˆæœºå™¨äºº...")
    from è¿è¡Œ.å¢å¼ºæœºå™¨äºº import ä¸»ç¨‹åº
    ä¸»ç¨‹åº()


def å¯åŠ¨å›¾å½¢ç•Œé¢():
    """å¯åŠ¨å›¾å½¢ç”¨æˆ·ç•Œé¢"""
    print("\nğŸ–¥ï¸  å¯åŠ¨å›¾å½¢ç•Œé¢...")
    print("   æ­£åœ¨åŠ è½½GUIç»„ä»¶ï¼Œè¯·ç¨å€™...")
    try:
        from ç•Œé¢.ä¸»ç¨‹åº import å¯åŠ¨åº”ç”¨
        import sys
        sys.exit(å¯åŠ¨åº”ç”¨())
    except ImportError as e:
        print(f"\nâŒ æ— æ³•å¯åŠ¨å›¾å½¢ç•Œé¢: {e}")
        print("   è¯·ç¡®ä¿å·²å®‰è£…PySide6: pip install PySide6")
        input("\næŒ‰å›è½¦é”®è¿”å›ä¸»èœå•...")
    except Exception as e:
        print(f"\nâŒ å¯åŠ¨å›¾å½¢ç•Œé¢æ—¶å‘ç”Ÿé”™è¯¯: {e}")
        input("\næŒ‰å›è½¦é”®è¿”å›ä¸»èœå•...")


def æ˜¾ç¤ºå¢å¼ºæ¨¡å—é…ç½®èœå•():
    """æ˜¾ç¤ºå¢å¼ºæ¨¡å—é…ç½®èœå•"""
    while True:
        print()
        print("=" * 60)
        print("âš™ï¸  å¢å¼ºæ¨¡å—é…ç½®")
        print("=" * 60)
        print()
        
        # è¯»å–å½“å‰é…ç½®
        from é…ç½®.å¢å¼ºè®¾ç½® import (
            YOLOé…ç½®, çŠ¶æ€è¯†åˆ«é…ç½®, å†³ç­–å¼•æ“é…ç½®, æ¨¡å—å¯ç”¨é…ç½®, æ€§èƒ½é…ç½®
        )
        
        print("ğŸ“‹ å½“å‰é…ç½®:")
        print()
        print("ã€æ¨¡å—å¯ç”¨çŠ¶æ€ã€‘")
        print(f"  YOLOæ£€æµ‹å™¨:   {'âœ“ å¯ç”¨' if æ¨¡å—å¯ç”¨é…ç½®.get('YOLOæ£€æµ‹å™¨', True) else 'âœ— ç¦ç”¨'}")
        print(f"  çŠ¶æ€è¯†åˆ«å™¨:   {'âœ“ å¯ç”¨' if æ¨¡å—å¯ç”¨é…ç½®.get('çŠ¶æ€è¯†åˆ«å™¨', True) else 'âœ— ç¦ç”¨'}")
        print(f"  å†³ç­–å¼•æ“:     {'âœ“ å¯ç”¨' if æ¨¡å—å¯ç”¨é…ç½®.get('å†³ç­–å¼•æ“', True) else 'âœ— ç¦ç”¨'}")
        print()
        print("ã€YOLOæ£€æµ‹å™¨é…ç½®ã€‘")
        print(f"  æ¨¡å‹è·¯å¾„:     {YOLOé…ç½®.get('æ¨¡å‹è·¯å¾„', 'æœªè®¾ç½®')}")
        print(f"  ç½®ä¿¡åº¦é˜ˆå€¼:   {YOLOé…ç½®.get('ç½®ä¿¡åº¦é˜ˆå€¼', 0.5)}")
        print(f"  æ£€æµ‹é—´éš”:     æ¯ {YOLOé…ç½®.get('æ£€æµ‹é—´éš”', 3)} å¸§")
        print()
        print("ã€çŠ¶æ€è¯†åˆ«é…ç½®ã€‘")
        print(f"  å†å²é•¿åº¦:     {çŠ¶æ€è¯†åˆ«é…ç½®.get('å†å²é•¿åº¦', 10)}")
        print(f"  ç½®ä¿¡åº¦ç´¯ç§¯:   {çŠ¶æ€è¯†åˆ«é…ç½®.get('ç½®ä¿¡åº¦ç´¯ç§¯ç³»æ•°', 0.1)}")
        print()
        print("ã€å†³ç­–å¼•æ“é…ç½®ã€‘")
        print(f"  å†³ç­–ç­–ç•¥:     {å†³ç­–å¼•æ“é…ç½®.get('ç­–ç•¥', 'æ··åˆåŠ æƒ')}")
        print(f"  è§„åˆ™æƒé‡:     {å†³ç­–å¼•æ“é…ç½®.get('è§„åˆ™æƒé‡', 0.6)}")
        print(f"  æ¨¡å‹æƒé‡:     {å†³ç­–å¼•æ“é…ç½®.get('æ¨¡å‹æƒé‡', 0.4)}")
        print()
        print("ã€æ€§èƒ½é…ç½®ã€‘")
        print(f"  å¸§ç‡é˜ˆå€¼:     {æ€§èƒ½é…ç½®.get('å¸§ç‡é˜ˆå€¼', 15)} FPS")
        print(f"  è‡ªåŠ¨é™çº§:     {'âœ“ å¯ç”¨' if æ€§èƒ½é…ç½®.get('è‡ªåŠ¨é™çº§', True) else 'âœ— ç¦ç”¨'}")
        print()
        print("ğŸ“‹ æ“ä½œé€‰é¡¹:")
        print("  1. æŸ¥çœ‹è¯¦ç»†é…ç½®è¯´æ˜")
        print("  2. æ‰“å¼€é…ç½®æ–‡ä»¶ (æ‰‹åŠ¨ç¼–è¾‘)")
        print("  0. è¿”å›ä¸»èœå•")
        print()
        
        é€‰æ‹© = input("è¯·è¾“å…¥é€‰é¡¹ (0-2): ").strip()
        
        if é€‰æ‹© == '0':
            break
        elif é€‰æ‹© == '1':
            æ˜¾ç¤ºé…ç½®è¯´æ˜()
        elif é€‰æ‹© == '2':
            print("\nğŸ“‚ é…ç½®æ–‡ä»¶ä½ç½®: é…ç½®/å¢å¼ºè®¾ç½®.py")
            print("   è¯·ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å¹¶ä¿®æ”¹é…ç½®")
            input("\næŒ‰å›è½¦é”®ç»§ç»­...")
        else:
            print("\nâŒ æ— æ•ˆé€‰é¡¹")
            input("æŒ‰å›è½¦é”®ç»§ç»­...")


def æ˜¾ç¤ºé…ç½®è¯´æ˜():
    """æ˜¾ç¤ºé…ç½®è¯´æ˜"""
    print()
    print("=" * 60)
    print("ğŸ“– é…ç½®è¯´æ˜")
    print("=" * 60)
    print()
    print("ã€YOLOæ£€æµ‹å™¨ã€‘")
    print("  æ¨¡å‹è·¯å¾„: YOLOæ¨¡å‹æ–‡ä»¶è·¯å¾„ (.ptæ ¼å¼)")
    print("  ç½®ä¿¡åº¦é˜ˆå€¼: 0.0-1.0ï¼Œä½äºæ­¤å€¼çš„æ£€æµ‹ç»“æœä¼šè¢«è¿‡æ»¤")
    print("  æ£€æµ‹é—´éš”: æ¯Nå¸§æ‰§è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œå€¼è¶Šå¤§æ€§èƒ½è¶Šå¥½ä½†å“åº”è¶Šæ…¢")
    print()
    print("ã€çŠ¶æ€è¯†åˆ«å™¨ã€‘")
    print("  å†å²é•¿åº¦: ä¿å­˜çš„çŠ¶æ€å†å²æ•°é‡ï¼Œç”¨äºçŠ¶æ€ç¨³å®šæ€§åˆ¤æ–­")
    print("  ç½®ä¿¡åº¦ç´¯ç§¯ç³»æ•°: è¿ç»­ç›¸åŒçŠ¶æ€æ—¶ç½®ä¿¡åº¦çš„å¢åŠ é‡")
    print()
    print("ã€å†³ç­–å¼•æ“ã€‘")
    print("  å†³ç­–ç­–ç•¥:")
    print("    - è§„åˆ™ä¼˜å…ˆ: ä¼˜å…ˆä½¿ç”¨è§„åˆ™ï¼Œè§„åˆ™ä¸åŒ¹é…æ—¶ä½¿ç”¨æ¨¡å‹")
    print("    - æ¨¡å‹ä¼˜å…ˆ: ä¼˜å…ˆä½¿ç”¨æ¨¡å‹ï¼Œç´§æ€¥è§„åˆ™å¯è¦†ç›–")
    print("    - æ··åˆåŠ æƒ: ç»“åˆè§„åˆ™å’Œæ¨¡å‹çš„åŠ æƒç»“æœ")
    print("  è§„åˆ™æƒé‡/æ¨¡å‹æƒé‡: æ··åˆåŠ æƒæ—¶çš„æƒé‡åˆ†é…")
    print()
    print("ã€æ€§èƒ½é…ç½®ã€‘")
    print("  å¸§ç‡é˜ˆå€¼: ä½äºæ­¤å¸§ç‡æ—¶è¿›å…¥ä½æ€§èƒ½æ¨¡å¼")
    print("  è‡ªåŠ¨é™çº§: æ€§èƒ½ä¸è¶³æ—¶è‡ªåŠ¨é™ä½æ£€æµ‹é¢‘ç‡")
    print()
    input("æŒ‰å›è½¦é”®è¿”å›...")


def æ˜¾ç¤ºæ•°æ®å·¥å…·èœå•():
    """æ˜¾ç¤ºæ•°æ®å·¥å…·å­èœå•"""
    while True:
        print()
        print("=" * 60)
        print("ğŸ”§ æ•°æ®å·¥å…·")
        print("=" * 60)
        print()
        print("ğŸ“‹ è¯·é€‰æ‹©åŠŸèƒ½:")
        print("  1. ğŸ“Š æ•°æ®é¢„å¤„ç† (å›¾åƒå¢å¼º)")
        print("  2. ğŸ§¹ æ•°æ®æ¸…æ´— (å¹³è¡¡ç±»åˆ«)")
        print("  3. âš–ï¸  ç±»åˆ«æƒé‡ (ä¼˜åŒ–æƒé‡)")
        print("  4. ğŸ“ˆ æŸ¥çœ‹æ•°æ®åˆ†å¸ƒ")
        print("  0. â†©ï¸  è¿”å›ä¸»èœå•")
        print()
        
        é€‰æ‹© = input("è¯·è¾“å…¥é€‰é¡¹ (0-4): ").strip()
        
        if é€‰æ‹© == '0':
            break
        elif é€‰æ‹© == '1':
            print("\nğŸ“Š å¯åŠ¨æ•°æ®é¢„å¤„ç†...")
            from å·¥å…·.æ•°æ®é¢„å¤„ç† import æ‰¹é‡é¢„å¤„ç†æ•°æ®
            æ‰¹é‡é¢„å¤„ç†æ•°æ®()
        elif é€‰æ‹© == '2':
            print("\nğŸ§¹ å¯åŠ¨æ•°æ®æ¸…æ´—...")
            from å·¥å…·.æ•°æ®æ¸…æ´— import æ‰¹é‡æ¸…æ´—æ•°æ®
            æ‰¹é‡æ¸…æ´—æ•°æ®()
        elif é€‰æ‹© == '3':
            print("\nâš–ï¸  å¯åŠ¨ç±»åˆ«æƒé‡å·¥å…·...")
            from å·¥å…·.ç±»åˆ«æƒé‡ import ä¸»ç¨‹åº as æƒé‡ä¸»ç¨‹åº
            æƒé‡ä¸»ç¨‹åº()
        elif é€‰æ‹© == '4':
            print("\nğŸ“ˆ æ•°æ®åˆ†å¸ƒç»Ÿè®¡...")
            from å·¥å…·.ç±»åˆ«æƒé‡ import æ˜¾ç¤ºæ•°æ®åˆ†å¸ƒ
            æ˜¾ç¤ºæ•°æ®åˆ†å¸ƒ()
            input("\næŒ‰å›è½¦é”®ç»§ç»­...")
        else:
            print("\nâŒ æ— æ•ˆé€‰é¡¹")
            input("æŒ‰å›è½¦é”®ç»§ç»­...")


def ä¸»ç¨‹åº():
    """ä¸»ç¨‹åºå…¥å£"""
    
    while True:
        æ˜¾ç¤ºä¸»èœå•()
        
        é€‰æ‹© = input("è¯·è¾“å…¥é€‰é¡¹ (0-8): ").strip()
        
        if é€‰æ‹© == '0':
            print("\nğŸ‘‹ å†è§ï¼")
            break
        elif é€‰æ‹© == '1':
            è¿è¡Œæ•°æ®æ”¶é›†()
        elif é€‰æ‹© == '2':
            è¿è¡Œè®­ç»ƒæ¨¡å‹()
        elif é€‰æ‹© == '3':
            è¿è¡Œæœºå™¨äºº()
        elif é€‰æ‹© == '4':
            è¿è¡Œå¢å¼ºæœºå™¨äºº()
        elif é€‰æ‹© == '5':
            æ˜¾ç¤ºæ•°æ®å·¥å…·èœå•()
        elif é€‰æ‹© == '6':
            æ˜¾ç¤ºå¢å¼ºæ¨¡å—é…ç½®èœå•()
        elif é€‰æ‹© == '7':
            æ˜¾ç¤ºå¸®åŠ©()
        elif é€‰æ‹© == '8':
            å¯åŠ¨å›¾å½¢ç•Œé¢()
        else:
            print("\nâŒ æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡æ–°è¾“å…¥")
            input("æŒ‰å›è½¦é”®ç»§ç»­...")


if __name__ == "__main__":
    try:
        # æ£€æŸ¥å‘½ä»¤è¡Œå‚æ•°
        if len(sys.argv) > 1:
            å‚æ•° = sys.argv[1].lower()
            if å‚æ•° in ['--gui', '-g', 'gui']:
                # ç›´æ¥å¯åŠ¨å›¾å½¢ç•Œé¢
                å¯åŠ¨å›¾å½¢ç•Œé¢()
            elif å‚æ•° in ['--help', '-h', 'help']:
                print()
                print("ğŸ® MMORPGæ¸¸æˆAIåŠ©æ‰‹ - å‘½ä»¤è¡Œå‚æ•°")
                print()
                print("ç”¨æ³•: python å¯åŠ¨.py [é€‰é¡¹]")
                print()
                print("é€‰é¡¹:")
                print("  --gui, -g    ç›´æ¥å¯åŠ¨å›¾å½¢ç•Œé¢")
                print("  --help, -h   æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯")
                print()
                print("æ— å‚æ•°æ—¶å¯åŠ¨å‘½ä»¤è¡Œèœå•ç•Œé¢")
                print()
            else:
                print(f"\nâŒ æœªçŸ¥å‚æ•°: {å‚æ•°}")
                print("   ä½¿ç”¨ --help æŸ¥çœ‹å¯ç”¨å‚æ•°")
        else:
            # æ— å‚æ•°æ—¶å¯åŠ¨å‘½ä»¤è¡Œèœå•
            ä¸»ç¨‹åº()
    except KeyboardInterrupt:
        print("\n\nğŸ‘‹ ç¨‹åºå·²é€€å‡º")
    except Exception as e:
        print(f"\nâŒ å‘ç”Ÿé”™è¯¯: {e}")
        input("æŒ‰å›è½¦é”®é€€å‡º...")
