# 设计文档

## 概述

修复 UI 界面中 emoji 字符在 Windows 系统上显示为方框（□）的问题。通过将 emoji 替换为纯文本或 ASCII 符号来确保跨平台兼容性。

## 问题分析

### 根本原因

Windows 系统的默认字体（如 Microsoft YaHei、Segoe UI）对某些 emoji 字符支持不完整，导致显示为方框。特别是：
- 🪟 (窗口) - U+1FA9F
- 🔍 (搜索) - U+1F50D  
- 🔄 (刷新) - U+1F504
- 🎯 (目标) - U+1F3AF
- 其他 emoji 字符

### 受影响的文件

根据代码扫描，以下界面文件使用了 emoji：

1. **界面/组件/窗口选择器.py** - 窗口选择对话框
2. **界面/组件/导航栏.py** - 主导航栏
3. **界面/组件/状态监控.py** - 状态监控组件
4. **界面/组件/通知服务.py** - 通知服务
5. **界面/页面/首页.py** - 首页
6. **界面/页面/配置页.py** - 配置页面
7. **界面/页面/运行页.py** - 运行页面
8. **界面/页面/训练页.py** - 训练页面
9. **界面/页面/数据管理页.py** - 数据管理页面
10. **界面/配置界面.py** - 配置界面

## 替换方案

### Emoji 到文本的映射表

| Emoji | 含义 | 替换方案 |
|-------|------|---------|
| 🪟 | 窗口 | [窗口] |
| 🔍 | 搜索 | [搜索] |
| 🔄 | 刷新 | [刷新] |
| 🎯 | 目标/选择 | [选择] |
| 🖱️ | 鼠标 | [鼠标] |
| ⚙️ | 设置 | [设置] |
| 🧠 | 模型/AI | [AI] |
| 📚 | 训练 | [训练] |
| 🚀 | 启动/运行 | [启动] |
| 📐 | 区域 | [区域] |
| 👁️ | 预览 | [预览] |
| 📂 | 文件夹 | [文件] |
| 💾 | 保存 | [保存] |
| ✓ | 确认 | [确认] |
| ⏱️ | 计时 | [计时] |
| 🟢 | 正常状态 | [正常] |
| 🔲 | 最小化 | [最小化] |
| 🖼️ | 图片 | [图片] |
| ❌ | 错误/不可用 | [X] |
| ✅ | 成功/可用 | [OK] |
| 🎮 | 游戏 | [游戏] |
| 📊 | 统计/图表 | [统计] |
| 🏠 | 首页 | [首页] |
| 📁 | 数据 | [数据] |
| ⚡ | 性能 | [性能] |
| 🔧 | 工具 | [工具] |
| 📝 | 日志 | [日志] |
| 🎥 | 录制 | [录制] |
| 🤖 | 机器人 | [运行] |
| ⚠️ | 警告 | [!] |
| ℹ️ | 信息 | [i] |
| 🔴 | 异常 | [异常] |
| ➡️ | 箭头 | -> |

## 组件修改清单

### 1. 界面/组件/窗口选择器.py

```python
# 修改前
self.setWindowTitle("🪟 选择游戏窗口")
标题标签 = QLabel("🪟 选择游戏窗口")
self._搜索框.setPlaceholderText("🔍 输入关键词过滤窗口...")
刷新按钮 = QPushButton("🔄 刷新")
self._点击选择按钮 = QPushButton("🎯 点击选择")
self._确认按钮 = QPushButton("✓ 确认选择")
缩略图标签.setText("🖼️")
状态文字 = "🔲 最小化" if ... else "🟢 正常"
点击选择说明 = QLabel("🖱️ 或者使用点击选择模式:")
self._倒计时标签.setText(f"⏱️ {self._倒计时剩余} 秒后请点击目标窗口...")

# 修改后
self.setWindowTitle("选择游戏窗口")
标题标签 = QLabel("选择游戏窗口")
self._搜索框.setPlaceholderText("输入关键词过滤窗口...")
刷新按钮 = QPushButton("刷新")
self._点击选择按钮 = QPushButton("点击选择")
self._确认按钮 = QPushButton("确认选择")
缩略图标签.setText("[图片]")
状态文字 = "[最小化]" if ... else "[正常]"
点击选择说明 = QLabel("或者使用点击选择模式:")
self._倒计时标签.setText(f"{self._倒计时剩余} 秒后请点击目标窗口...")
```

### 2. 界面/组件/导航栏.py

```python
# 修改前
导航项配置 = [
    ("🏠", "首页"),
    ("🎥", "数据收集"),
    ("🧠", "训练"),
    ("🤖", "运行"),
    ("⚙️", "配置"),
    ("📁", "数据管理"),
]

# 修改后 - 使用纯文本
导航项配置 = [
    ("", "首页"),
    ("", "数据收集"),
    ("", "训练"),
    ("", "运行"),
    ("", "配置"),
    ("", "数据管理"),
]
```

### 3. 其他文件类似处理

## 正确性属性

### Property 1: 无方框字符

*对于任意* UI 组件的文本内容，显示时不应出现方框字符（□）

**验证: 需求 4.1**

### Property 2: 文本语义保持

*对于任意* 替换操作，替换后的文本应保持原有的语义含义

**验证: 需求 2.2**

## 错误处理

| 场景 | 处理方式 |
|-----|---------|
| 遗漏的 emoji | 运行时检查，记录警告日志 |
| 替换后文本过长 | 调整布局或缩短文本 |

## 测试策略

### 手动测试

1. 启动 GUI 应用
2. 检查所有页面的标题、按钮、标签
3. 确认无方框字符显示
4. 验证窗口选择对话框正常显示

### 自动化检查

创建脚本扫描所有 Python 文件，检测是否还有 emoji 字符残留
