# 需求文档

## 简介

实时训练预览功能，在训练过程中可视化 loss 曲线、准确率变化等指标，帮助开发者判断训练是否正常进行，及时发现问题。

## 术语表

- **训练监控器**: 负责收集和展示训练指标的模块
- **指标记录器**: 记录每个 epoch/batch 训练指标的模块
- **实时图表**: 动态更新的训练曲线图

## 需求列表

### 需求 1: 指标收集

**用户故事:** 作为开发者，我希望自动收集训练指标，以便监控训练进度。

#### 验收标准

1. 指标记录器应在每个 batch 后记录 loss 值
2. 指标记录器应在每个 epoch 后记录准确率
3. 指标记录器应在执行验证时记录验证 loss 和准确率
4. 指标记录器应在学习率变化时记录学习率
5. 指标记录器应将指标保存到日志文件以便后续分析

### 需求 2: 实时曲线图

**用户故事:** 作为开发者，我希望看到实时训练曲线，以便实时监控训练。

#### 验收标准

1. 实时图表应显示实时更新的 loss 曲线
2. 实时图表应在同一图表上显示训练和验证指标
3. 实时图表应支持在不同子图中显示多个指标
4. 实时图表应按可配置的间隔更新（默认：每 10 个 batch）
5. 实时图表不应阻塞训练过程

### 需求 3: 训练状态指示

**用户故事:** 作为开发者，我希望有训练健康状况的视觉指示器，以便快速识别问题。

#### 验收标准

1. 训练监控器应检测 loss 是否不再下降（可能的平台期）
2. 训练监控器应检测 loss 是否在上升（可能的发散）
3. 训练监控器应检测大的 loss 尖峰（可能的数据问题）
4. 当检测到问题时，训练监控器应显示警告信息
5. 训练监控器应使用颜色编码指示训练健康状况（绿色/黄色/红色）

### 需求 4: 终端输出优化

**用户故事:** 作为开发者，我希望训练期间有信息丰富的终端输出，以便无需 GUI 也能监控。

#### 验收标准

1. 训练监控器应为每个 epoch 显示进度条
2. 训练监控器应显示当前 loss、准确率和预计剩余时间
3. 训练监控器应在每个 epoch 结束时显示摘要
4. 训练监控器应支持最小输出的静默模式

### 需求 5: 历史对比

**用户故事:** 作为开发者，我希望将当前训练与之前的运行进行比较，以便评估改进效果。

#### 验收标准

1. 训练监控器应支持从之前的训练运行加载指标
2. 实时图表应支持在当前图表上叠加之前运行的曲线
3. 训练监控器应高亮显示运行之间的差异
4. 训练监控器应保存训练历史以便将来比较
