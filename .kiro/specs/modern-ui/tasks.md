# 实现计划: 现代化UI界面

## 概述

基于PySide6框架实现MMORPG游戏AI助手的现代化图形用户界面，采用左侧导航栏 + 状态仪表盘首页的布局风格，固定窗口尺寸800x600像素。

## 任务列表

- [x] 1. 项目结构和基础设置
  - [x] 1.1 创建界面模块目录结构
    - 创建 `界面/` 目录及子目录 (`组件/`, `页面/`, `线程/`, `样式/`)
    - 创建各目录的 `__init__.py` 文件
    - _Requirements: 1.1, 1.2, 1.3, 1.4_
  - [x] 1.2 添加PySide6依赖
    - 更新 `requirements.txt` 添加 PySide6 和 pyqtgraph
    - _Requirements: 1.1_
  - [x] 1.3 创建样式主题文件
    - 创建 `界面/样式/主题.py` 定义颜色常量和QSS样式表
    - _Requirements: 10.1, 10.2, 10.3, 10.4, 10.5, 10.6_

- [x] 2. 核心组件开发
  - [x] 2.1 实现主窗口类 (MainWindow)
    - 创建 `界面/主程序.py`
    - 实现固定尺寸800x600窗口
    - 实现左侧导航栏 + 右侧内容区域布局
    - 实现页面切换功能 (QStackedWidget)
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6_
  - [ ]* 2.2 编写主窗口单元测试
    - 测试窗口尺寸是否为800x600
    - 测试导航栏和内容区域是否存在
    - _Requirements: 1.5_
  - [x] 2.3 实现导航栏组件 (NavigationBar)
    - 创建 `界面/组件/导航栏.py`
    - 实现导航项列表 (首页/数据收集/训练/运行/配置/数据管理)
    - 实现选中状态高亮
    - 实现点击切换页面信号
    - _Requirements: 1.2, 1.6_
  - [ ]* 2.4 编写导航栏属性测试
    - **Property 1: 导航切换一致性**
    - **Validates: Requirements 1.4, 1.6**

- [x] 3. 首页开发 (状态仪表盘)
  - [x] 3.1 实现首页组件
    - 创建 `界面/页面/首页.py`
    - 实现系统状态卡片 (模型状态/GPU/数据文件/上次训练)
    - 实现4个快捷操作按钮
    - 实现使用提示区域
    - _Requirements: 1.4_
  - [x] 3.2 实现系统状态检测逻辑
    - 检测模型文件是否存在
    - 检测GPU是否可用
    - 统计数据文件数量和样本数
    - _Requirements: 1.4_

- [x] 4. 数据收集页面开发
  - [x] 4.1 实现数据收集页面
    - 创建 `界面/页面/数据收集页.py`
    - 实现控制面板 (开始/暂停/停止按钮)
    - 实现状态监控区域 (录制状态/样本数量/文件编号)
    - 实现游戏画面预览区域
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7_
  - [x] 4.2 实现数据收集后台线程
    - 创建 `界面/线程/数据收集线程.py`
    - 集成现有的数据收集逻辑
    - 实现进度信号和状态更新
    - _Requirements: 9.1_
  - [ ]* 4.3 编写数据收集状态属性测试
    - **Property 2: 数据收集状态显示一致性**
    - **Validates: Requirements 2.2, 2.3**

- [x] 5. 训练页面开发
  - [x] 5.1 实现训练页面
    - 创建 `界面/页面/训练页.py`
    - 实现模式选择 (主线任务/自动战斗)
    - 实现控制面板 (开始训练/停止训练)
    - 实现进度条和轮次显示
    - 实现损失值曲线图 (使用pyqtgraph或matplotlib)
    - 实现日志显示区域
    - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7_
  - [x] 5.2 实现训练后台线程
    - 创建 `界面/线程/训练线程.py`
    - 集成现有的训练逻辑
    - 实现进度和损失值信号
    - _Requirements: 9.2_
  - [ ]* 5.3 编写训练进度属性测试
    - **Property 4: 训练进度显示一致性**
    - **Validates: Requirements 3.3**

- [x] 6. 运行页面开发
  - [x] 6.1 实现运行页面
    - 创建 `界面/页面/运行页.py`
    - 实现模式选择 (基础模式/增强模式)
    - 实现子模式选择 (主线任务/自动战斗)
    - 实现控制面板 (启动/暂停/停止)
    - 实现状态监控 (动作/游戏状态/帧率/运动量/增强模块状态)
    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9_
  - [x] 6.2 实现运行后台线程
    - 创建 `界面/线程/运行线程.py`
    - 集成现有的机器人运行逻辑
    - 实现状态更新信号
    - _Requirements: 9.3_
  - [ ]* 6.3 编写运行状态属性测试
    - **Property 6: 运行状态显示一致性**
    - **Validates: Requirements 4.4, 4.5, 4.6, 4.7**

- [x] 7. 配置页面开发
  - [x] 7.1 实现配置页面
    - 创建 `界面/页面/配置页.py`
    - 实现分类配置显示 (游戏窗口/模型/训练/增强模块)
    - 实现各类型输入控件 (滑块/输入框/下拉框/开关)
    - 实现配置说明文字
    - 实现保存和重置按钮
    - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7_
  - [ ]* 7.2 编写配置验证属性测试
    - **Property 7: 配置验证逻辑**
    - **Validates: Requirements 5.5, 5.7**
  - [ ]* 7.3 编写配置保存属性测试
    - **Property 8: 配置保存一致性**
    - **Validates: Requirements 5.6**

- [x] 8. 数据管理页面开发
  - [x] 8.1 实现数据管理页面
    - 创建 `界面/页面/数据管理页.py`
    - 实现文件列表显示 (文件名/大小/时间/样本数)
    - 实现数据分布统计图表
    - 实现预处理和清洗快捷按钮
    - 实现删除确认对话框
    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5, 6.6_
  - [ ]* 8.2 编写数据显示属性测试
    - **Property 9: 数据文件显示一致性**
    - **Validates: Requirements 6.1, 6.2, 6.3**

- [x] 9. 通用组件开发
  - [x] 9.1 实现日志查看器组件
    - 创建 `界面/组件/日志查看器.py`
    - 实现带时间戳的日志显示
    - 实现级别过滤功能
    - 实现搜索功能
    - 实现导出功能
    - _Requirements: 7.1, 7.2, 7.3, 7.4_
  - [ ]* 9.2 编写日志功能属性测试
    - **Property 5: 日志显示功能**
    - **Validates: Requirements 3.6, 7.1, 7.2, 7.3**
  - [x] 9.3 实现通知服务
    - 实现弹出通知功能 (右下角Toast)
    - 实现错误通知和详情查看
    - _Requirements: 7.5, 7.6_
  - [x] 9.4 实现状态监控组件
    - 创建 `界面/组件/状态监控.py`
    - 实现状态颜色编码 (绿色/黄色/红色)
    - 实现游戏画面预览
    - _Requirements: 10.6_
  - [ ]* 9.5 编写状态颜色属性测试
    - **Property 14: 状态颜色编码**
    - **Validates: Requirements 10.6**

- [x] 10. 快捷键和响应性
  - [x] 10.1 实现全局快捷键
    - 实现T键暂停/继续
    - 实现ESC键停止
    - 实现Ctrl+S保存配置
    - 实现快捷键列表显示
    - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5_
  - [ ]* 10.2 编写快捷键属性测试
    - **Property 10: 快捷键功能**
    - **Validates: Requirements 8.1, 8.2, 8.5**
  - [ ]* 10.3 编写界面响应性属性测试
    - **Property 11: 后台任务界面响应性**
    - **Validates: Requirements 9.1, 9.2, 9.3**
  - [ ]* 10.4 编写状态更新延迟属性测试
    - **Property 12: 状态更新延迟**
    - **Validates: Requirements 9.4**

- [x] 11. 错误处理和安全性
  - [x] 11.1 实现错误处理机制
    - 实现后台线程错误捕获
    - 实现错误日志记录
    - 实现错误通知显示
    - _Requirements: 9.5_
  - [ ]* 11.2 编写错误处理属性测试
    - **Property 13: 错误处理安全性**
    - **Validates: Requirements 9.5**

- [x] 12. 集成和入口
  - [x] 12.1 创建GUI启动入口
    - 修改 `启动.py` 添加GUI启动选项
    - 或创建独立的 `启动GUI.py`
    - _Requirements: 1.1_
  - [x] 12.2 集成测试
    - 测试完整的页面切换流程
    - 测试数据收集完整流程
    - 测试训练完整流程
    - 测试机器人运行完整流程
    - _Requirements: 所有_

- [x] 13. 检查点 - 确保所有测试通过
  - 运行所有单元测试和属性测试
  - 确保界面功能正常
  - 如有问题请询问用户

## 备注

- 标记 `*` 的任务为可选测试任务，可跳过以加快MVP开发
- 每个任务都引用了对应的需求编号以便追溯
- 属性测试验证通用正确性属性，确保代码质量
- 检查点用于确保增量验证
