# 需求文档

## 简介

断点续训功能，支持训练过程中保存检查点，训练中断后可以从上次中断处继续训练，避免重新开始。

## 术语表

- **检查点管理器**: 负责保存和加载训练状态的模块
- **训练状态**: 包括模型权重、优化器状态、当前轮次等信息
- **恢复点**: 训练中断时的状态快照

## 需求列表

### 需求 1: 检查点保存

**用户故事:** 作为开发者，我希望定期保存训练检查点，以便在训练中断时能够恢复。

#### 验收标准

1. 检查点管理器应按可配置的间隔保存训练状态（默认：每个 epoch）
2. 保存检查点时，检查点管理器应包含模型权重、优化器状态、当前 epoch 和当前 batch
3. 检查点管理器应支持保存到指定目录
4. 检查点管理器应维护最大检查点数量（默认：5 个）并删除旧的检查点
5. 当检查点保存完成时，检查点管理器应记录检查点路径和训练进度

### 需求 2: 训练恢复

**用户故事:** 作为开发者，我希望能从检查点恢复训练，以便不丢失训练进度。

#### 验收标准

1. 当提供检查点目录时，检查点管理器应列出所有可用的检查点
2. 检查点管理器应默认加载最新的检查点
3. 加载检查点时，检查点管理器应恢复模型权重、优化器状态和训练进度
4. 如果检查点损坏，检查点管理器应返回错误并建议使用更早的检查点
5. 当训练恢复时，系统应从中断的确切 batch 继续

### 需求 3: 检查点元数据

**用户故事:** 作为开发者，我希望能查看检查点元数据，以便选择从哪个检查点恢复。

#### 验收标准

1. 检查点管理器应为每个检查点保存元数据（时间戳、epoch、batch、loss 值）
2. 检查点管理器应提供方法列出所有检查点及其元数据
3. 检查点管理器应支持按 epoch 编号或时间戳加载特定检查点

### 需求 4: 自动恢复

**用户故事:** 作为用户，我希望训练脚本能自动检测并提供从最新检查点恢复的选项。

#### 验收标准

1. 当训练开始时，系统应检查输出目录中是否存在检查点
2. 如果存在检查点，系统应提示用户选择恢复或重新开始
3. 当用户选择恢复时，系统应自动加载最新的检查点
