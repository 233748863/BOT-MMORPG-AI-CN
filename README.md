# 🎮 MMORPG游戏AI助手 (中文版)

基于深度学习的MMORPG游戏自动化助手，专注于**主线任务练级**和**自动战斗**训练。

## ✨ 功能特点

- 🎯 **主线任务自动化** - 学习玩家做主线任务的操作习惯
- ⚔️ **自动战斗训练** - 学习战斗技能释放和走位
- 🖥️ **屏幕实时识别** - 基于计算机视觉的游戏画面分析
- ⌨️ **键盘控制** - 支持WASD移动和组合键
- 📊 **可视化训练** - 实时查看训练进度和效果

## 📁 项目结构

```
BOT-MMORPG-AI-CN/
├── 启动.py              # 主启动器
├── 测试环境.py          # 环境检测工具
├── 核心/                # 核心功能模块
│   ├── 屏幕截取.py      # 游戏画面捕获
│   ├── 键盘控制.py      # 键盘输入模拟
│   ├── 鼠标控制.py      # 鼠标输入模拟
│   ├── 按键检测.py      # 按键状态检测
│   ├── 动作检测.py      # 画面动作检测
│   └── 模型定义.py      # AI模型架构
├── 训练/                # 训练相关
│   ├── 收集数据.py      # 数据收集脚本
│   └── 训练模型.py      # 模型训练脚本
├── 运行/                # 运行相关
│   └── 运行机器人.py    # 主运行脚本
├── 工具/                # 辅助工具
│   ├── 数据预处理.py    # 图像增强/数据增强
│   ├── 数据清洗.py      # 数据平衡/清洗
│   ├── 类别权重.py      # 权重优化工具
│   └── 目标检测.py      # YOLO目标检测
├── 模型/                # 保存的模型文件
├── 数据/                # 训练数据
└── 配置/                # 配置文件
    └── 设置.py          # 全局设置
```

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 测试环境

```bash
python 测试环境.py
```

### 3. 启动程序

```bash
python 启动.py
```

## 📋 使用流程

### 第一步: 收集训练数据

1. 运行 `python 启动.py`，选择 "数据收集"
2. 切换到游戏窗口
3. 正常玩游戏，AI会记录你的操作
4. 按 `T` 暂停/继续录制
5. 按 `Q` 退出并保存

### 第二步: 训练模型

1. 运行 `python 启动.py`，选择 "训练模型"
2. 等待训练完成
3. 建议至少收集10个数据文件再训练

### 第三步: 运行AI

1. 运行 `python 启动.py`，选择 "运行机器人"
2. 选择模式 (主线任务/自动战斗)
3. 切换到游戏窗口
4. 按 `T` 暂停/继续
5. 按 `ESC` 退出

## 🎯 训练模式

### 主线任务模式
专注于学习：
- NPC对话交互
- 任务目标寻路
- 物品拾取操作
- 场景切换判断

### 自动战斗模式
专注于学习：
- 技能释放时机
- 走位躲避技能
- 目标选择策略
- 连招组合操作

## 🎮 支持的操作 (32种动作)

| 类型 | 动作编号 | 操作 |
|------|----------|------|
| 移动 | 0-8 | W, S, A, D, W+A, W+D, S+A, S+D, 无操作 |
| 技能 | 9-18 | 1, 2, 3, 4, 5, 6, Q, E, R, F |
| 特殊 | 19-21 | 空格(跳跃/闪避), Tab(切换目标), F(交互) |
| 鼠标 | 22-24 | 左键, 右键, 中键 |
| Shift组合 | 25-28 | Shift+1, Shift+2, Shift+Q, Shift+E |
| Ctrl组合 | 29-31 | Ctrl+1, Ctrl+2, Ctrl+Q |

## ⚙️ 配置说明

编辑 `配置/设置.py` 自定义：
- 游戏窗口区域
- 按键映射
- 模型参数
- 训练参数

## 🔧 数据工具

### 数据预处理
对训练数据进行图像增强，提高模型泛化能力：
- 随机亮度/对比度调整
- 高斯模糊/噪声
- 随机裁剪缩放

### 数据清洗
平衡各动作类别的样本数量，避免模型偏向：
- 自动统计类别分布
- 按中位数平衡样本
- 随机采样保持多样性

### 类别权重优化
自动调整各动作类别的预测权重：
- 根据数据分布计算初始权重
- 迭代优化减少预测偏差
- 导出权重到配置文件

## 📋 系统要求

- Windows 10/11
- Python 3.8+
- NVIDIA GPU (推荐，CPU也可运行)
- 8GB+ 内存

## 🔧 依赖安装

### 方案1: TensorFlow 2.15 + 官方TFLearn (稳定)
```bash
pip install tensorflow==2.15.0
pip install tflearn==0.5.0
pip install opencv-python numpy pywin32
```

### 方案2: TensorFlow 2.16+ + 修复版TFLearn (推荐)
```bash
pip install tensorflow
pip install git+https://github.com/MihaMarkic/tflearn.git@fix/is_sequence_missing
pip install opencv-python numpy pywin32
```

> 注意：官方TFLearn与TensorFlow 2.16+有兼容性问题（`is_sequence`函数缺失），社区修复版已解决此问题。

## ⚠️ 免责声明

本项目仅供学习和研究目的。使用本工具可能违反某些游戏的服务条款，请自行承担风险。

## 📄 许可证

Apache 2.0 License
