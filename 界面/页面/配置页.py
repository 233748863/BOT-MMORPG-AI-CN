# -*- coding: utf-8 -*-
"""
é…ç½®é¡µé¢

æä¾›å›¾å½¢åŒ–çš„é…ç½®ç®¡ç†ç•Œé¢ï¼Œæ”¯æŒ:
- æ ‡ç­¾é¡µå½¢å¼ç»„ç»‡é…ç½®é¡¹ (æ¸¸æˆçª—å£/æ¨¡å‹è®¾ç½®/è®­ç»ƒå‚æ•°/å¢å¼ºæ¨¡å—)
- å„ç±»å‹è¾“å…¥æ§ä»¶ (æ»‘å—/è¾“å…¥æ¡†/ä¸‹æ‹‰æ¡†/å¼€å…³)
- é…ç½®è¯´æ˜æ–‡å­—
- ä¿å­˜å’Œé‡ç½®åŠŸèƒ½
- å®æ—¶éªŒè¯è¾“å…¥æœ‰æ•ˆæ€§
- å¤šæ¸¸æˆé…ç½®æ¡£æ¡ˆç®¡ç† (éœ€æ±‚ 6.1, 6.3, 6.5)

å¸ƒå±€ä¼˜åŒ– (Requirements 5.1, 5.2, 5.3, 5.5):
- é‡‡ç”¨æ ‡ç­¾é¡µå½¢å¼ç»„ç»‡ä¸åŒç±»åˆ«çš„é…ç½®
- åŒ…å«4ä¸ªæ ‡ç­¾é¡µï¼šæ¸¸æˆçª—å£ã€æ¨¡å‹è®¾ç½®ã€è®­ç»ƒå‚æ•°ã€å¢å¼ºæ¨¡å—
- æ¯ä¸ªæ ‡ç­¾é¡µä½¿ç”¨è¡¨å•å¸ƒå±€ï¼Œæ ‡ç­¾åœ¨å·¦ï¼Œæ§ä»¶åœ¨å³
- ä¿å­˜å’Œé‡ç½®æŒ‰é’®å›ºå®šåœ¨é¡µé¢åº•éƒ¨
"""

from PySide6.QtWidgets import (
    QWidget, QVBoxLayout, QHBoxLayout, QScrollArea,
    QFrame, QLabel, QPushButton, QLineEdit, QSpinBox,
    QDoubleSpinBox, QComboBox, QCheckBox, QSlider,
    QFormLayout, QMessageBox, QSizePolicy,
    QFileDialog, QInputDialog, QTabWidget
)
from PySide6.QtCore import Qt, Signal
from PySide6.QtGui import QFont

from ç•Œé¢.æ ·å¼.ä¸»é¢˜ import é¢œè‰²
from ç•Œé¢.æ ·å¼.å¸ƒå±€å¸¸é‡ import å¸ƒå±€å¸¸é‡
from ç•Œé¢.ç»„ä»¶.é€šç”¨ç»„ä»¶ import Card


class é…ç½®é¡µ(QWidget):
    """é…ç½®ç®¡ç†é¡µé¢ - æ ‡ç­¾é¡µå½¢å¼å¸ƒå±€"""
    
    # ä¿¡å·å®šä¹‰
    é…ç½®å·²ä¿å­˜ = Signal()
    é…ç½®å·²é‡ç½® = Signal()
    æ¡£æ¡ˆå·²åˆ‡æ¢ = Signal(str)  # æ¡£æ¡ˆåˆ‡æ¢ä¿¡å·ï¼Œå‚æ•°ä¸ºæ¡£æ¡ˆåç§°
    
    def __init__(self, parent=None):
        super().__init__(parent)
        self._é…ç½®æ§ä»¶ = {}  # å­˜å‚¨æ‰€æœ‰é…ç½®æ§ä»¶çš„å¼•ç”¨
        self._åŸå§‹å€¼ = {}    # å­˜å‚¨åŸå§‹é…ç½®å€¼ç”¨äºé‡ç½®
        self._é…ç½®ç®¡ç†å™¨ = None  # é…ç½®ç®¡ç†å™¨å®ä¾‹
        self._åˆå§‹åŒ–é…ç½®ç®¡ç†å™¨()
        self._åˆå§‹åŒ–ç•Œé¢()
        self._åŠ è½½é…ç½®()
    
    def _åˆå§‹åŒ–é…ç½®ç®¡ç†å™¨(self):
        """åˆå§‹åŒ–é…ç½®ç®¡ç†å™¨"""
        try:
            from æ ¸å¿ƒ.é…ç½®ç®¡ç† import ConfigManager
            self._é…ç½®ç®¡ç†å™¨ = ConfigManager(auto_load_last=True)
        except Exception as e:
            print(f"åˆå§‹åŒ–é…ç½®ç®¡ç†å™¨å¤±è´¥: {e}")
            self._é…ç½®ç®¡ç†å™¨ = None
    
    def _åˆå§‹åŒ–ç•Œé¢(self):
        """åˆå§‹åŒ–ç•Œé¢å¸ƒå±€ - æ ‡ç­¾é¡µå½¢å¼ (Requirements 5.1)"""
        ä¸»å¸ƒå±€ = QVBoxLayout(self)
        ä¸»å¸ƒå±€.setContentsMargins(
            å¸ƒå±€å¸¸é‡.å†…å®¹åŒºå¤–è¾¹è·,
            å¸ƒå±€å¸¸é‡.å†…å®¹åŒºå¤–è¾¹è·,
            å¸ƒå±€å¸¸é‡.å†…å®¹åŒºå¤–è¾¹è·,
            å¸ƒå±€å¸¸é‡.å†…å®¹åŒºå¤–è¾¹è·
        )
        ä¸»å¸ƒå±€.setSpacing(å¸ƒå±€å¸¸é‡.å¡ç‰‡é—´è·)
        
        # é¡µé¢æ ‡é¢˜
        æ ‡é¢˜ = QLabel("âš™ï¸ é…ç½®ç®¡ç†")
        æ ‡é¢˜.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.é¡µé¢æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
        """)
        ä¸»å¸ƒå±€.addWidget(æ ‡é¢˜)
        
        # æ¡£æ¡ˆç®¡ç†åŒºåŸŸ (éœ€æ±‚ 6.1, 6.3, 6.5)
        ä¸»å¸ƒå±€.addWidget(self._åˆ›å»ºæ¡£æ¡ˆç®¡ç†å¡ç‰‡())
        
        # æ ‡ç­¾é¡µå®¹å™¨ (Requirements 5.1, 5.2)
        self._æ ‡ç­¾é¡µ = QTabWidget()
        self._æ ‡ç­¾é¡µ.setStyleSheet(f"""
            QTabWidget::pane {{
                border: {å¸ƒå±€å¸¸é‡.å¡ç‰‡è¾¹æ¡†å®½åº¦}px solid {é¢œè‰².è¾¹æ¡†};
                border-radius: {å¸ƒå±€å¸¸é‡.å¡ç‰‡åœ†è§’}px;
                background-color: {é¢œè‰².å¡ç‰‡èƒŒæ™¯};
                padding: {å¸ƒå±€å¸¸é‡.å¡ç‰‡å†…è¾¹è·}px;
            }}
            QTabBar::tab {{
                background-color: {é¢œè‰².å¡ç‰‡èƒŒæ™¯};
                border: 1px solid {é¢œè‰².è¾¹æ¡†};
                border-bottom: none;
                border-top-left-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                border-top-right-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                padding: 8px 16px;
                margin-right: 2px;
                font-size: {å¸ƒå±€å¸¸é‡.æ­£æ–‡å­—å·}px;
                color: {é¢œè‰².æ–‡å­—};
            }}
            QTabBar::tab:selected {{
                background-color: {é¢œè‰².ä¸»è‰²};
                color: white;
                font-weight: bold;
            }}
            QTabBar::tab:hover:!selected {{
                background-color: {é¢œè‰².æ‚¬åœèƒŒæ™¯};
            }}
        """)
        
        # æ·»åŠ 4ä¸ªæ ‡ç­¾é¡µ (Requirements 5.2)
        self._æ ‡ç­¾é¡µ.addTab(self._åˆ›å»ºæ¸¸æˆçª—å£æ ‡ç­¾é¡µ(), "ğŸ® æ¸¸æˆçª—å£")
        self._æ ‡ç­¾é¡µ.addTab(self._åˆ›å»ºæ¨¡å‹è®¾ç½®æ ‡ç­¾é¡µ(), "ğŸ§  æ¨¡å‹è®¾ç½®")
        self._æ ‡ç­¾é¡µ.addTab(self._åˆ›å»ºè®­ç»ƒå‚æ•°æ ‡ç­¾é¡µ(), "ğŸ“š è®­ç»ƒå‚æ•°")
        self._æ ‡ç­¾é¡µ.addTab(self._åˆ›å»ºå¢å¼ºæ¨¡å—æ ‡ç­¾é¡µ(), "ğŸš€ å¢å¼ºæ¨¡å—")
        
        ä¸»å¸ƒå±€.addWidget(self._æ ‡ç­¾é¡µ, 1)
        
        # åº•éƒ¨æŒ‰é’®åŒºåŸŸ (Requirements 5.5)
        ä¸»å¸ƒå±€.addWidget(self._åˆ›å»ºåº•éƒ¨æŒ‰é’®åŒºåŸŸ())
    
    def _åˆ›å»ºæ¡£æ¡ˆç®¡ç†å¡ç‰‡(self) -> Card:
        """åˆ›å»ºæ¡£æ¡ˆç®¡ç†å¡ç‰‡ (éœ€æ±‚ 6.1, 6.3, 6.5)"""
        å¡ç‰‡ = Card("ğŸ“ é…ç½®æ¡£æ¡ˆ")
        
        # æ¡£æ¡ˆç®¡ç†å¸ƒå±€
        æ¡£æ¡ˆå¸ƒå±€ = QHBoxLayout()
        æ¡£æ¡ˆå¸ƒå±€.setSpacing(å¸ƒå±€å¸¸é‡.æŒ‰é’®é—´è·)
        
        # æ¡£æ¡ˆé€‰æ‹©ä¸‹æ‹‰æ¡† (éœ€æ±‚ 6.1)
        self._æ¡£æ¡ˆé€‰æ‹© = QComboBox()
        self._æ¡£æ¡ˆé€‰æ‹©.setFixedWidth(160)
        self._æ¡£æ¡ˆé€‰æ‹©.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._æ¡£æ¡ˆé€‰æ‹©.currentTextChanged.connect(self._åˆ‡æ¢æ¡£æ¡ˆ)
        æ¡£æ¡ˆå¸ƒå±€.addWidget(self._æ¡£æ¡ˆé€‰æ‹©)
        
        # æ–°å»ºæ¡£æ¡ˆæŒ‰é’®
        self._æ–°å»ºæ¡£æ¡ˆæŒ‰é’® = QPushButton("â• æ–°å»º")
        self._æ–°å»ºæ¡£æ¡ˆæŒ‰é’®.setFixedSize(70, å¸ƒå±€å¸¸é‡.æŒ‰é’®é«˜åº¦)
        self._æ–°å»ºæ¡£æ¡ˆæŒ‰é’®.setStyleSheet(f"""
            QPushButton {{
                background-color: {é¢œè‰².æˆåŠŸ};
                color: white;
                border: none;
                border-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                font-size: {å¸ƒå±€å¸¸é‡.æŒ‰é’®æ–‡å­—å­—å·}px;
            }}
            QPushButton:hover {{
                background-color: #059669;
            }}
        """)
        self._æ–°å»ºæ¡£æ¡ˆæŒ‰é’®.clicked.connect(self._æ–°å»ºæ¡£æ¡ˆ)
        æ¡£æ¡ˆå¸ƒå±€.addWidget(self._æ–°å»ºæ¡£æ¡ˆæŒ‰é’®)
        
        # å¯¼å…¥æŒ‰é’® (éœ€æ±‚ 6.5)
        self._å¯¼å…¥æŒ‰é’® = QPushButton("ğŸ“¥ å¯¼å…¥")
        self._å¯¼å…¥æŒ‰é’®.setFixedSize(70, å¸ƒå±€å¸¸é‡.æŒ‰é’®é«˜åº¦)
        self._å¯¼å…¥æŒ‰é’®.setStyleSheet(f"""
            QPushButton {{
                background-color: {é¢œè‰².å¡ç‰‡èƒŒæ™¯};
                color: {é¢œè‰².æ–‡å­—};
                border: 1px solid {é¢œè‰².è¾¹æ¡†};
                border-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                font-size: {å¸ƒå±€å¸¸é‡.æŒ‰é’®æ–‡å­—å­—å·}px;
            }}
            QPushButton:hover {{
                background-color: {é¢œè‰².æ‚¬åœèƒŒæ™¯};
            }}
        """)
        self._å¯¼å…¥æŒ‰é’®.clicked.connect(self._å¯¼å…¥æ¡£æ¡ˆ)
        æ¡£æ¡ˆå¸ƒå±€.addWidget(self._å¯¼å…¥æŒ‰é’®)
        
        # å¯¼å‡ºæŒ‰é’® (éœ€æ±‚ 6.3)
        self._å¯¼å‡ºæŒ‰é’® = QPushButton("ğŸ“¤ å¯¼å‡º")
        self._å¯¼å‡ºæŒ‰é’®.setFixedSize(70, å¸ƒå±€å¸¸é‡.æŒ‰é’®é«˜åº¦)
        self._å¯¼å‡ºæŒ‰é’®.setStyleSheet(f"""
            QPushButton {{
                background-color: {é¢œè‰².å¡ç‰‡èƒŒæ™¯};
                color: {é¢œè‰².æ–‡å­—};
                border: 1px solid {é¢œè‰².è¾¹æ¡†};
                border-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                font-size: {å¸ƒå±€å¸¸é‡.æŒ‰é’®æ–‡å­—å­—å·}px;
            }}
            QPushButton:hover {{
                background-color: {é¢œè‰².æ‚¬åœèƒŒæ™¯};
            }}
        """)
        self._å¯¼å‡ºæŒ‰é’®.clicked.connect(self._å¯¼å‡ºæ¡£æ¡ˆ)
        æ¡£æ¡ˆå¸ƒå±€.addWidget(self._å¯¼å‡ºæŒ‰é’®)
        
        # åˆ é™¤æŒ‰é’®
        self._åˆ é™¤æ¡£æ¡ˆæŒ‰é’® = QPushButton("ğŸ—‘ï¸")
        self._åˆ é™¤æ¡£æ¡ˆæŒ‰é’®.setFixedSize(32, å¸ƒå±€å¸¸é‡.æŒ‰é’®é«˜åº¦)
        self._åˆ é™¤æ¡£æ¡ˆæŒ‰é’®.setStyleSheet(f"""
            QPushButton {{
                background-color: {é¢œè‰².å¡ç‰‡èƒŒæ™¯};
                color: {é¢œè‰².é”™è¯¯};
                border: 1px solid {é¢œè‰².è¾¹æ¡†};
                border-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                font-size: 14px;
            }}
            QPushButton:hover {{
                background-color: #FEE2E2;
                border-color: {é¢œè‰².é”™è¯¯};
            }}
        """)
        self._åˆ é™¤æ¡£æ¡ˆæŒ‰é’®.clicked.connect(self._åˆ é™¤æ¡£æ¡ˆ)
        æ¡£æ¡ˆå¸ƒå±€.addWidget(self._åˆ é™¤æ¡£æ¡ˆæŒ‰é’®)
        
        æ¡£æ¡ˆå¸ƒå±€.addStretch()
        
        å¡ç‰‡.æ·»åŠ å¸ƒå±€(æ¡£æ¡ˆå¸ƒå±€)
        
        # åˆ·æ–°æ¡£æ¡ˆåˆ—è¡¨
        self._åˆ·æ–°æ¡£æ¡ˆåˆ—è¡¨()
        
        return å¡ç‰‡
    
    def _åˆ›å»ºæ ‡ç­¾é¡µå†…å®¹(self, è¡¨å•å¸ƒå±€: QFormLayout) -> QWidget:
        """åˆ›å»ºæ ‡ç­¾é¡µå†…å®¹å®¹å™¨ï¼Œæ”¯æŒæ»šåŠ¨ (Requirements 5.6)"""
        # æ»šåŠ¨åŒºåŸŸ
        æ»šåŠ¨åŒºåŸŸ = QScrollArea()
        æ»šåŠ¨åŒºåŸŸ.setWidgetResizable(True)
        æ»šåŠ¨åŒºåŸŸ.setFrameShape(QFrame.NoFrame)
        æ»šåŠ¨åŒºåŸŸ.setHorizontalScrollBarPolicy(Qt.ScrollBarAlwaysOff)
        
        # å†…å®¹å®¹å™¨
        å†…å®¹å®¹å™¨ = QWidget()
        å†…å®¹å¸ƒå±€ = QVBoxLayout(å†…å®¹å®¹å™¨)
        å†…å®¹å¸ƒå±€.setContentsMargins(å¸ƒå±€å¸¸é‡.å¡ç‰‡å†…è¾¹è·, å¸ƒå±€å¸¸é‡.å¡ç‰‡å†…è¾¹è·,
                                  å¸ƒå±€å¸¸é‡.å¡ç‰‡å†…è¾¹è·, å¸ƒå±€å¸¸é‡.å¡ç‰‡å†…è¾¹è·)
        å†…å®¹å¸ƒå±€.setSpacing(å¸ƒå±€å¸¸é‡.è¡¨å•è¡Œé—´è·)
        
        å†…å®¹å¸ƒå±€.addLayout(è¡¨å•å¸ƒå±€)
        å†…å®¹å¸ƒå±€.addStretch()
        
        æ»šåŠ¨åŒºåŸŸ.setWidget(å†…å®¹å®¹å™¨)
        return æ»šåŠ¨åŒºåŸŸ
    
    def _åˆ›å»ºæ¸¸æˆçª—å£æ ‡ç­¾é¡µ(self) -> QWidget:
        """åˆ›å»ºæ¸¸æˆçª—å£é…ç½®æ ‡ç­¾é¡µ (Requirements 5.3)"""
        è¡¨å•å¸ƒå±€ = QFormLayout()
        è¡¨å•å¸ƒå±€.setSpacing(å¸ƒå±€å¸¸é‡.è¡¨å•è¡Œé—´è·)
        è¡¨å•å¸ƒå±€.setLabelAlignment(Qt.AlignRight | Qt.AlignVCenter)
        
        # å¿«æ·é€‰æ‹©åˆ†ç»„ - ä»è¿›ç¨‹è·å–çª—å£
        åˆ†ç»„æ ‡é¢˜0 = QLabel("ğŸ¯ å¿«æ·é€‰æ‹©")
        åˆ†ç»„æ ‡é¢˜0.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 8px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜0)
        
        # è¿›ç¨‹é€‰æ‹©åŒºåŸŸ
        è¿›ç¨‹é€‰æ‹©å®¹å™¨ = QWidget()
        è¿›ç¨‹é€‰æ‹©å¸ƒå±€ = QHBoxLayout(è¿›ç¨‹é€‰æ‹©å®¹å™¨)
        è¿›ç¨‹é€‰æ‹©å¸ƒå±€.setContentsMargins(0, 0, 0, 0)
        è¿›ç¨‹é€‰æ‹©å¸ƒå±€.setSpacing(8)
        
        # è¿›ç¨‹ä¸‹æ‹‰æ¡†
        self._è¿›ç¨‹é€‰æ‹© = QComboBox()
        self._è¿›ç¨‹é€‰æ‹©.setFixedWidth(280)
        self._è¿›ç¨‹é€‰æ‹©.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._è¿›ç¨‹é€‰æ‹©.setPlaceholderText("é€‰æ‹©æ¸¸æˆçª—å£...")
        è¿›ç¨‹é€‰æ‹©å¸ƒå±€.addWidget(self._è¿›ç¨‹é€‰æ‹©)
        
        # åˆ·æ–°æŒ‰é’®
        self._åˆ·æ–°è¿›ç¨‹æŒ‰é’® = QPushButton("ğŸ”„")
        self._åˆ·æ–°è¿›ç¨‹æŒ‰é’®.setFixedSize(32, å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._åˆ·æ–°è¿›ç¨‹æŒ‰é’®.setToolTip("åˆ·æ–°çª—å£åˆ—è¡¨")
        self._åˆ·æ–°è¿›ç¨‹æŒ‰é’®.setStyleSheet(f"""
            QPushButton {{
                background-color: {é¢œè‰².å¡ç‰‡èƒŒæ™¯};
                color: {é¢œè‰².æ–‡å­—};
                border: 1px solid {é¢œè‰².è¾¹æ¡†};
                border-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                font-size: 14px;
            }}
            QPushButton:hover {{
                background-color: {é¢œè‰².æ‚¬åœèƒŒæ™¯};
            }}
        """)
        self._åˆ·æ–°è¿›ç¨‹æŒ‰é’®.clicked.connect(self._åˆ·æ–°çª—å£åˆ—è¡¨)
        è¿›ç¨‹é€‰æ‹©å¸ƒå±€.addWidget(self._åˆ·æ–°è¿›ç¨‹æŒ‰é’®)
        
        # åº”ç”¨æŒ‰é’®
        self._åº”ç”¨çª—å£æŒ‰é’® = QPushButton("ğŸ“ åº”ç”¨")
        self._åº”ç”¨çª—å£æŒ‰é’®.setFixedSize(60, å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._åº”ç”¨çª—å£æŒ‰é’®.setToolTip("å°†é€‰ä¸­çª—å£çš„ä½ç½®åº”ç”¨åˆ°é…ç½®")
        self._åº”ç”¨çª—å£æŒ‰é’®.setStyleSheet(f"""
            QPushButton {{
                background-color: {é¢œè‰².æˆåŠŸ};
                color: white;
                border: none;
                border-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                font-size: {å¸ƒå±€å¸¸é‡.æŒ‰é’®æ–‡å­—å­—å·}px;
            }}
            QPushButton:hover {{
                background-color: #059669;
            }}
        """)
        self._åº”ç”¨çª—å£æŒ‰é’®.clicked.connect(self._åº”ç”¨é€‰ä¸­çª—å£)
        è¿›ç¨‹é€‰æ‹©å¸ƒå±€.addWidget(self._åº”ç”¨çª—å£æŒ‰é’®)
        
        è¿›ç¨‹é€‰æ‹©å¸ƒå±€.addStretch()
        
        è¡¨å•å¸ƒå±€.addRow("æ¸¸æˆçª—å£:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(è¿›ç¨‹é€‰æ‹©å®¹å™¨, "é€‰æ‹©æ¸¸æˆè¿›ç¨‹ï¼Œè‡ªåŠ¨è·å–çª—å£ä½ç½®"))
        
        # åˆå§‹åŒ–æ—¶åˆ·æ–°çª—å£åˆ—è¡¨
        self._åˆ·æ–°çª—å£åˆ—è¡¨()
        
        # çª—å£åŒºåŸŸè®¾ç½®åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜1 = QLabel("ğŸ“ çª—å£åŒºåŸŸ")
        åˆ†ç»„æ ‡é¢˜1.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 8px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜1)
        
        # æ¸¸æˆçª—å£åŒºåŸŸ - å·¦
        å·¦è¾¹ç•Œ = QSpinBox()
        å·¦è¾¹ç•Œ.setRange(0, 3840)
        å·¦è¾¹ç•Œ.setSuffix(" px")
        å·¦è¾¹ç•Œ.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        å·¦è¾¹ç•Œ.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å·¦"] = å·¦è¾¹ç•Œ
        è¡¨å•å¸ƒå±€.addRow("çª—å£å·¦è¾¹ç•Œ:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(å·¦è¾¹ç•Œ, "æ¸¸æˆçª—å£å·¦ä¾§èµ·å§‹ä½ç½®"))
        
        # æ¸¸æˆçª—å£åŒºåŸŸ - ä¸Š
        ä¸Šè¾¹ç•Œ = QSpinBox()
        ä¸Šè¾¹ç•Œ.setRange(0, 2160)
        ä¸Šè¾¹ç•Œ.setSuffix(" px")
        ä¸Šè¾¹ç•Œ.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        ä¸Šè¾¹ç•Œ.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸Š"] = ä¸Šè¾¹ç•Œ
        è¡¨å•å¸ƒå±€.addRow("çª—å£ä¸Šè¾¹ç•Œ:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(ä¸Šè¾¹ç•Œ, "æ¸¸æˆçª—å£é¡¶éƒ¨èµ·å§‹ä½ç½®"))
        
        # æ¸¸æˆçª—å£åŒºåŸŸ - å³
        å³è¾¹ç•Œ = QSpinBox()
        å³è¾¹ç•Œ.setRange(0, 3840)
        å³è¾¹ç•Œ.setSuffix(" px")
        å³è¾¹ç•Œ.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        å³è¾¹ç•Œ.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å³"] = å³è¾¹ç•Œ
        è¡¨å•å¸ƒå±€.addRow("çª—å£å³è¾¹ç•Œ:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(å³è¾¹ç•Œ, "æ¸¸æˆçª—å£å³ä¾§ç»“æŸä½ç½®"))
        
        # æ¸¸æˆçª—å£åŒºåŸŸ - ä¸‹
        ä¸‹è¾¹ç•Œ = QSpinBox()
        ä¸‹è¾¹ç•Œ.setRange(0, 2160)
        ä¸‹è¾¹ç•Œ.setSuffix(" px")
        ä¸‹è¾¹ç•Œ.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        ä¸‹è¾¹ç•Œ.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸‹"] = ä¸‹è¾¹ç•Œ
        è¡¨å•å¸ƒå±€.addRow("çª—å£ä¸‹è¾¹ç•Œ:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(ä¸‹è¾¹ç•Œ, "æ¸¸æˆçª—å£åº•éƒ¨ç»“æŸä½ç½®"))
        
        # åˆ†è¾¨ç‡è®¾ç½®åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜2 = QLabel("ğŸ–¼ï¸ åˆ†è¾¨ç‡è®¾ç½®")
        åˆ†ç»„æ ‡é¢˜2.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 12px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜2)
        
        # æ¸¸æˆåˆ†è¾¨ç‡ - å®½åº¦
        æ¸¸æˆå®½åº¦ = QSpinBox()
        æ¸¸æˆå®½åº¦.setRange(640, 3840)
        æ¸¸æˆå®½åº¦.setSuffix(" px")
        æ¸¸æˆå®½åº¦.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        æ¸¸æˆå®½åº¦.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¸¸æˆå®½åº¦"] = æ¸¸æˆå®½åº¦
        è¡¨å•å¸ƒå±€.addRow("æ¸¸æˆå®½åº¦:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(æ¸¸æˆå®½åº¦, "æ¸¸æˆç”»é¢çš„æ°´å¹³åˆ†è¾¨ç‡"))
        
        # æ¸¸æˆåˆ†è¾¨ç‡ - é«˜åº¦
        æ¸¸æˆé«˜åº¦ = QSpinBox()
        æ¸¸æˆé«˜åº¦.setRange(480, 2160)
        æ¸¸æˆé«˜åº¦.setSuffix(" px")
        æ¸¸æˆé«˜åº¦.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        æ¸¸æˆé«˜åº¦.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¸¸æˆé«˜åº¦"] = æ¸¸æˆé«˜åº¦
        è¡¨å•å¸ƒå±€.addRow("æ¸¸æˆé«˜åº¦:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(æ¸¸æˆé«˜åº¦, "æ¸¸æˆç”»é¢çš„å‚ç›´åˆ†è¾¨ç‡"))
        
        return self._åˆ›å»ºæ ‡ç­¾é¡µå†…å®¹(è¡¨å•å¸ƒå±€)
    
    def _åˆ·æ–°çª—å£åˆ—è¡¨(self):
        """åˆ·æ–°å¯ç”¨çª—å£åˆ—è¡¨"""
        self._è¿›ç¨‹é€‰æ‹©.clear()
        self._çª—å£ä¿¡æ¯ç¼“å­˜ = {}  # ç¼“å­˜çª—å£ä¿¡æ¯
        
        try:
            import ctypes
            from ctypes import wintypes
            
            # Windows API
            user32 = ctypes.windll.user32
            
            # æšä¸¾çª—å£å›è°ƒå‡½æ•°
            çª—å£åˆ—è¡¨ = []
            
            def æšä¸¾çª—å£å›è°ƒ(hwnd, lParam):
                # æ£€æŸ¥çª—å£æ˜¯å¦å¯è§
                if not user32.IsWindowVisible(hwnd):
                    return True
                
                # è·å–çª—å£æ ‡é¢˜
                é•¿åº¦ = user32.GetWindowTextLengthW(hwnd)
                if é•¿åº¦ == 0:
                    return True
                
                ç¼“å†²åŒº = ctypes.create_unicode_buffer(é•¿åº¦ + 1)
                user32.GetWindowTextW(hwnd, ç¼“å†²åŒº, é•¿åº¦ + 1)
                æ ‡é¢˜ = ç¼“å†²åŒº.value
                
                # è¿‡æ»¤æ‰ä¸€äº›ç³»ç»Ÿçª—å£
                æ’é™¤åˆ—è¡¨ = ['Program Manager', 'MSCTFIME UI', 'Default IME', 
                          'Windows Input Experience', 'Settings', '']
                if æ ‡é¢˜ in æ’é™¤åˆ—è¡¨:
                    return True
                
                # è·å–çª—å£ä½ç½®
                rect = wintypes.RECT()
                user32.GetWindowRect(hwnd, ctypes.byref(rect))
                
                # è¿‡æ»¤æ‰å¤ªå°çš„çª—å£
                å®½åº¦ = rect.right - rect.left
                é«˜åº¦ = rect.bottom - rect.top
                if å®½åº¦ < 200 or é«˜åº¦ < 200:
                    return True
                
                çª—å£åˆ—è¡¨.append({
                    'hwnd': hwnd,
                    'æ ‡é¢˜': æ ‡é¢˜,
                    'å·¦': rect.left,
                    'ä¸Š': rect.top,
                    'å³': rect.right,
                    'ä¸‹': rect.bottom,
                    'å®½åº¦': å®½åº¦,
                    'é«˜åº¦': é«˜åº¦
                })
                return True
            
            # å®šä¹‰å›è°ƒç±»å‹
            WNDENUMPROC = ctypes.WINFUNCTYPE(ctypes.c_bool, wintypes.HWND, wintypes.LPARAM)
            æšä¸¾å›è°ƒ = WNDENUMPROC(æšä¸¾çª—å£å›è°ƒ)
            
            # æšä¸¾æ‰€æœ‰çª—å£
            user32.EnumWindows(æšä¸¾å›è°ƒ, 0)
            
            # æ·»åŠ åˆ°ä¸‹æ‹‰æ¡†
            for çª—å£ in çª—å£åˆ—è¡¨:
                æ˜¾ç¤ºæ–‡æœ¬ = f"{çª—å£['æ ‡é¢˜'][:30]}... ({çª—å£['å®½åº¦']}x{çª—å£['é«˜åº¦']})" if len(çª—å£['æ ‡é¢˜']) > 30 else f"{çª—å£['æ ‡é¢˜']} ({çª—å£['å®½åº¦']}x{çª—å£['é«˜åº¦']})"
                self._è¿›ç¨‹é€‰æ‹©.addItem(æ˜¾ç¤ºæ–‡æœ¬)
                self._çª—å£ä¿¡æ¯ç¼“å­˜[æ˜¾ç¤ºæ–‡æœ¬] = çª—å£
            
            if not çª—å£åˆ—è¡¨:
                self._è¿›ç¨‹é€‰æ‹©.addItem("(æœªæ‰¾åˆ°å¯ç”¨çª—å£)")
                
        except Exception as e:
            print(f"åˆ·æ–°çª—å£åˆ—è¡¨å¤±è´¥: {e}")
            self._è¿›ç¨‹é€‰æ‹©.addItem("(è·å–çª—å£åˆ—è¡¨å¤±è´¥)")
    
    def _åº”ç”¨é€‰ä¸­çª—å£(self):
        """å°†é€‰ä¸­çª—å£çš„ä½ç½®åº”ç”¨åˆ°é…ç½®"""
        å½“å‰é€‰æ‹© = self._è¿›ç¨‹é€‰æ‹©.currentText()
        
        if not å½“å‰é€‰æ‹© or å½“å‰é€‰æ‹©.startswith("("):
            QMessageBox.warning(self, "æç¤º", "è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæœ‰æ•ˆçš„æ¸¸æˆçª—å£")
            return
        
        if å½“å‰é€‰æ‹© not in self._çª—å£ä¿¡æ¯ç¼“å­˜:
            QMessageBox.warning(self, "æç¤º", "çª—å£ä¿¡æ¯å·²å¤±æ•ˆï¼Œè¯·åˆ·æ–°åˆ—è¡¨åé‡è¯•")
            return
        
        çª—å£ä¿¡æ¯ = self._çª—å£ä¿¡æ¯ç¼“å­˜[å½“å‰é€‰æ‹©]
        
        # åº”ç”¨çª—å£ä½ç½®
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å·¦"].setValue(max(0, çª—å£ä¿¡æ¯['å·¦']))
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸Š"].setValue(max(0, çª—å£ä¿¡æ¯['ä¸Š']))
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å³"].setValue(çª—å£ä¿¡æ¯['å³'])
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸‹"].setValue(çª—å£ä¿¡æ¯['ä¸‹'])
        
        # åŒæ­¥æ›´æ–°åˆ†è¾¨ç‡
        self._é…ç½®æ§ä»¶["æ¸¸æˆå®½åº¦"].setValue(çª—å£ä¿¡æ¯['å®½åº¦'])
        self._é…ç½®æ§ä»¶["æ¸¸æˆé«˜åº¦"].setValue(çª—å£ä¿¡æ¯['é«˜åº¦'])
        
        QMessageBox.information(
            self, "æˆåŠŸ", 
            f"å·²åº”ç”¨çª—å£ \"{çª—å£ä¿¡æ¯['æ ‡é¢˜'][:20]}...\" çš„ä½ç½®\n"
            f"åŒºåŸŸ: ({çª—å£ä¿¡æ¯['å·¦']}, {çª—å£ä¿¡æ¯['ä¸Š']}, {çª—å£ä¿¡æ¯['å³']}, {çª—å£ä¿¡æ¯['ä¸‹']})\n"
            f"åˆ†è¾¨ç‡: {çª—å£ä¿¡æ¯['å®½åº¦']} x {çª—å£ä¿¡æ¯['é«˜åº¦']}"
        )
    
    def _åˆ›å»ºæ¨¡å‹è®¾ç½®æ ‡ç­¾é¡µ(self) -> QWidget:
        """åˆ›å»ºæ¨¡å‹è®¾ç½®é…ç½®æ ‡ç­¾é¡µ (Requirements 5.3)"""
        è¡¨å•å¸ƒå±€ = QFormLayout()
        è¡¨å•å¸ƒå±€.setSpacing(å¸ƒå±€å¸¸é‡.è¡¨å•è¡Œé—´è·)
        è¡¨å•å¸ƒå±€.setLabelAlignment(Qt.AlignRight | Qt.AlignVCenter)
        
        # è¾“å…¥å°ºå¯¸åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜1 = QLabel("ğŸ“ è¾“å…¥å°ºå¯¸")
        åˆ†ç»„æ ‡é¢˜1.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 8px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜1)
        
        # æ¨¡å‹è¾“å…¥å®½åº¦
        è¾“å…¥å®½åº¦ = QSpinBox()
        è¾“å…¥å®½åº¦.setRange(120, 960)
        è¾“å…¥å®½åº¦.setSingleStep(10)
        è¾“å…¥å®½åº¦.setSuffix(" px")
        è¾“å…¥å®½åº¦.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        è¾“å…¥å®½åº¦.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥å®½åº¦"] = è¾“å…¥å®½åº¦
        è¡¨å•å¸ƒå±€.addRow("è¾“å…¥å®½åº¦:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(è¾“å…¥å®½åº¦, "æ¨¡å‹è¾“å…¥å›¾åƒçš„å®½åº¦ï¼Œå½±å“å¤„ç†é€Ÿåº¦"))
        
        # æ¨¡å‹è¾“å…¥é«˜åº¦
        è¾“å…¥é«˜åº¦ = QSpinBox()
        è¾“å…¥é«˜åº¦.setRange(68, 540)
        è¾“å…¥é«˜åº¦.setSingleStep(10)
        è¾“å…¥é«˜åº¦.setSuffix(" px")
        è¾“å…¥é«˜åº¦.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        è¾“å…¥é«˜åº¦.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥é«˜åº¦"] = è¾“å…¥é«˜åº¦
        è¡¨å•å¸ƒå±€.addRow("è¾“å…¥é«˜åº¦:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(è¾“å…¥é«˜åº¦, "æ¨¡å‹è¾“å…¥å›¾åƒçš„é«˜åº¦ï¼Œå½±å“å¤„ç†é€Ÿåº¦"))
        
        # è·¯å¾„è®¾ç½®åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜2 = QLabel("ğŸ“‚ è·¯å¾„è®¾ç½®")
        åˆ†ç»„æ ‡é¢˜2.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 12px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜2)
        
        # æ¨¡å‹ä¿å­˜è·¯å¾„
        æ¨¡å‹è·¯å¾„ = QLineEdit()
        æ¨¡å‹è·¯å¾„.setPlaceholderText("æ¨¡å‹/æ¸¸æˆAI")
        æ¨¡å‹è·¯å¾„.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å¤§å®½åº¦)
        æ¨¡å‹è·¯å¾„.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¨¡å‹ä¿å­˜è·¯å¾„"] = æ¨¡å‹è·¯å¾„
        è¡¨å•å¸ƒå±€.addRow("æ¨¡å‹è·¯å¾„:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(æ¨¡å‹è·¯å¾„, "è®­ç»ƒåæ¨¡å‹çš„ä¿å­˜ä½ç½®"))
        
        # é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„
        é¢„è®­ç»ƒè·¯å¾„ = QLineEdit()
        é¢„è®­ç»ƒè·¯å¾„.setPlaceholderText("æ¨¡å‹/é¢„è®­ç»ƒæ¨¡å‹/test")
        é¢„è®­ç»ƒè·¯å¾„.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å¤§å®½åº¦)
        é¢„è®­ç»ƒè·¯å¾„.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„"] = é¢„è®­ç»ƒè·¯å¾„
        è¡¨å•å¸ƒå±€.addRow("é¢„è®­ç»ƒæ¨¡å‹:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(é¢„è®­ç»ƒè·¯å¾„, "é¢„è®­ç»ƒæ¨¡å‹çš„åŠ è½½è·¯å¾„"))
        
        return self._åˆ›å»ºæ ‡ç­¾é¡µå†…å®¹(è¡¨å•å¸ƒå±€)
    
    def _åˆ›å»ºè®­ç»ƒå‚æ•°æ ‡ç­¾é¡µ(self) -> QWidget:
        """åˆ›å»ºè®­ç»ƒå‚æ•°é…ç½®æ ‡ç­¾é¡µ (Requirements 5.3)"""
        è¡¨å•å¸ƒå±€ = QFormLayout()
        è¡¨å•å¸ƒå±€.setSpacing(å¸ƒå±€å¸¸é‡.è¡¨å•è¡Œé—´è·)
        è¡¨å•å¸ƒå±€.setLabelAlignment(Qt.AlignRight | Qt.AlignVCenter)
        
        # è®­ç»ƒè®¾ç½®åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜1 = QLabel("âš™ï¸ è®­ç»ƒè®¾ç½®")
        åˆ†ç»„æ ‡é¢˜1.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 8px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜1)
        
        # å­¦ä¹ ç‡ - ä½¿ç”¨æ»‘å—å’Œè¾“å…¥æ¡†ç»„åˆ
        å­¦ä¹ ç‡å®¹å™¨ = QWidget()
        å­¦ä¹ ç‡å¸ƒå±€ = QHBoxLayout(å­¦ä¹ ç‡å®¹å™¨)
        å­¦ä¹ ç‡å¸ƒå±€.setContentsMargins(0, 0, 0, 0)
        å­¦ä¹ ç‡å¸ƒå±€.setSpacing(8)
        
        å­¦ä¹ ç‡æ»‘å— = QSlider(Qt.Horizontal)
        å­¦ä¹ ç‡æ»‘å—.setRange(1, 100)  # 0.0001 åˆ° 0.01
        å­¦ä¹ ç‡æ»‘å—.setValue(10)  # é»˜è®¤ 0.001
        å­¦ä¹ ç‡æ»‘å—.setFixedWidth(100)
        
        å­¦ä¹ ç‡è¾“å…¥ = QDoubleSpinBox()
        å­¦ä¹ ç‡è¾“å…¥.setRange(0.0001, 0.01)
        å­¦ä¹ ç‡è¾“å…¥.setDecimals(4)
        å­¦ä¹ ç‡è¾“å…¥.setSingleStep(0.0001)
        å­¦ä¹ ç‡è¾“å…¥.setFixedWidth(80)
        å­¦ä¹ ç‡è¾“å…¥.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        
        # æ»‘å—å’Œè¾“å…¥æ¡†è”åŠ¨
        def æ»‘å—æ›´æ–°è¾“å…¥(å€¼):
            å­¦ä¹ ç‡è¾“å…¥.setValue(å€¼ / 10000)
        
        def è¾“å…¥æ›´æ–°æ»‘å—(å€¼):
            å­¦ä¹ ç‡æ»‘å—.setValue(int(å€¼ * 10000))
        
        å­¦ä¹ ç‡æ»‘å—.valueChanged.connect(æ»‘å—æ›´æ–°è¾“å…¥)
        å­¦ä¹ ç‡è¾“å…¥.valueChanged.connect(è¾“å…¥æ›´æ–°æ»‘å—)
        
        å­¦ä¹ ç‡å¸ƒå±€.addWidget(å­¦ä¹ ç‡æ»‘å—)
        å­¦ä¹ ç‡å¸ƒå±€.addWidget(å­¦ä¹ ç‡è¾“å…¥)
        
        self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡"] = å­¦ä¹ ç‡è¾“å…¥
        self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡_æ»‘å—"] = å­¦ä¹ ç‡æ»‘å—
        è¡¨å•å¸ƒå±€.addRow("å­¦ä¹ ç‡:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(å­¦ä¹ ç‡å®¹å™¨, "æ¨¡å‹è®­ç»ƒçš„å­¦ä¹ ç‡ï¼Œå»ºè®®èŒƒå›´ 0.0001-0.01"))
        
        # è®­ç»ƒè½®æ•°
        è®­ç»ƒè½®æ•° = QSpinBox()
        è®­ç»ƒè½®æ•°.setRange(1, 100)
        è®­ç»ƒè½®æ•°.setSuffix(" è½®")
        è®­ç»ƒè½®æ•°.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        è®­ç»ƒè½®æ•°.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["è®­ç»ƒè½®æ•°"] = è®­ç»ƒè½®æ•°
        è¡¨å•å¸ƒå±€.addRow("è®­ç»ƒè½®æ•°:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(è®­ç»ƒè½®æ•°, "æ¨¡å‹è®­ç»ƒçš„æ€»è½®æ•°"))
        
        # æ•°æ®è®¾ç½®åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜2 = QLabel("ğŸ“Š æ•°æ®è®¾ç½®")
        åˆ†ç»„æ ‡é¢˜2.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 12px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜2)
        
        # æ¯æ–‡ä»¶æ ·æœ¬æ•°
        æ ·æœ¬æ•° = QSpinBox()
        æ ·æœ¬æ•°.setRange(100, 5000)
        æ ·æœ¬æ•°.setSingleStep(100)
        æ ·æœ¬æ•°.setSuffix(" ä¸ª")
        æ ·æœ¬æ•°.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        æ ·æœ¬æ•°.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ¯æ–‡ä»¶æ ·æœ¬æ•°"] = æ ·æœ¬æ•°
        è¡¨å•å¸ƒå±€.addRow("æ¯æ–‡ä»¶æ ·æœ¬æ•°:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(æ ·æœ¬æ•°, "æ¯ä¸ªæ•°æ®æ–‡ä»¶ä¿å­˜çš„æ ·æœ¬æ•°é‡"))
        
        # æ•°æ®ä¿å­˜è·¯å¾„
        æ•°æ®è·¯å¾„ = QLineEdit()
        æ•°æ®è·¯å¾„.setPlaceholderText("æ•°æ®/")
        æ•°æ®è·¯å¾„.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å¤§å®½åº¦)
        æ•°æ®è·¯å¾„.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["æ•°æ®ä¿å­˜è·¯å¾„"] = æ•°æ®è·¯å¾„
        è¡¨å•å¸ƒå±€.addRow("æ•°æ®è·¯å¾„:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(æ•°æ®è·¯å¾„, "è®­ç»ƒæ•°æ®çš„ä¿å­˜ç›®å½•"))
        
        # è¿åŠ¨æ£€æµ‹é˜ˆå€¼
        è¿åŠ¨é˜ˆå€¼ = QSpinBox()
        è¿åŠ¨é˜ˆå€¼.setRange(100, 5000)
        è¿åŠ¨é˜ˆå€¼.setSingleStep(100)
        è¿åŠ¨é˜ˆå€¼.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        è¿åŠ¨é˜ˆå€¼.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["è¿åŠ¨æ£€æµ‹é˜ˆå€¼"] = è¿åŠ¨é˜ˆå€¼
        è¡¨å•å¸ƒå±€.addRow("è¿åŠ¨æ£€æµ‹é˜ˆå€¼:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(è¿åŠ¨é˜ˆå€¼, "ä½äºæ­¤å€¼è®¤ä¸ºè§’è‰²å¡ä½"))
        
        return self._åˆ›å»ºæ ‡ç­¾é¡µå†…å®¹(è¡¨å•å¸ƒå±€)

    def _åˆ›å»ºå¢å¼ºæ¨¡å—æ ‡ç­¾é¡µ(self) -> QWidget:
        """åˆ›å»ºå¢å¼ºæ¨¡å—é…ç½®æ ‡ç­¾é¡µ (Requirements 5.3)"""
        è¡¨å•å¸ƒå±€ = QFormLayout()
        è¡¨å•å¸ƒå±€.setSpacing(å¸ƒå±€å¸¸é‡.è¡¨å•è¡Œé—´è·)
        è¡¨å•å¸ƒå±€.setLabelAlignment(Qt.AlignRight | Qt.AlignVCenter)
        
        # YOLOæ£€æµ‹å™¨åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜1 = QLabel("ğŸ¯ YOLOæ£€æµ‹å™¨")
        åˆ†ç»„æ ‡é¢˜1.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 8px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜1)
        
        # YOLOæ£€æµ‹å™¨å¼€å…³
        yoloå¯ç”¨ = QCheckBox("å¯ç”¨YOLOç›®æ ‡æ£€æµ‹")
        yoloå¯ç”¨.setStyleSheet("QCheckBox { spacing: 8px; }")
        self._é…ç½®æ§ä»¶["YOLOå¯ç”¨"] = yoloå¯ç”¨
        è¡¨å•å¸ƒå±€.addRow("", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(yoloå¯ç”¨, "å¯ç”¨åå¯æ£€æµ‹æ¸¸æˆä¸­çš„æ€ªç‰©ã€NPCç­‰å®ä½“"))
        
        # YOLOç½®ä¿¡åº¦é˜ˆå€¼
        yoloç½®ä¿¡åº¦å®¹å™¨ = QWidget()
        yoloç½®ä¿¡åº¦å¸ƒå±€ = QHBoxLayout(yoloç½®ä¿¡åº¦å®¹å™¨)
        yoloç½®ä¿¡åº¦å¸ƒå±€.setContentsMargins(0, 0, 0, 0)
        yoloç½®ä¿¡åº¦å¸ƒå±€.setSpacing(8)
        
        yoloç½®ä¿¡åº¦æ»‘å— = QSlider(Qt.Horizontal)
        yoloç½®ä¿¡åº¦æ»‘å—.setRange(10, 90)
        yoloç½®ä¿¡åº¦æ»‘å—.setValue(50)
        yoloç½®ä¿¡åº¦æ»‘å—.setFixedWidth(100)
        
        yoloç½®ä¿¡åº¦æ ‡ç­¾ = QLabel("0.50")
        yoloç½®ä¿¡åº¦æ ‡ç­¾.setFixedWidth(40)
        
        def æ›´æ–°ç½®ä¿¡åº¦æ ‡ç­¾(å€¼):
            yoloç½®ä¿¡åº¦æ ‡ç­¾.setText(f"{å€¼/100:.2f}")
        
        yoloç½®ä¿¡åº¦æ»‘å—.valueChanged.connect(æ›´æ–°ç½®ä¿¡åº¦æ ‡ç­¾)
        
        yoloç½®ä¿¡åº¦å¸ƒå±€.addWidget(yoloç½®ä¿¡åº¦æ»‘å—)
        yoloç½®ä¿¡åº¦å¸ƒå±€.addWidget(yoloç½®ä¿¡åº¦æ ‡ç­¾)
        
        self._é…ç½®æ§ä»¶["YOLOç½®ä¿¡åº¦"] = yoloç½®ä¿¡åº¦æ»‘å—
        è¡¨å•å¸ƒå±€.addRow("YOLOç½®ä¿¡åº¦:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(yoloç½®ä¿¡åº¦å®¹å™¨, "æ£€æµ‹ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œè¶Šé«˜è¶Šä¸¥æ ¼"))
        
        # YOLOæ£€æµ‹é—´éš”
        yoloé—´éš” = QSpinBox()
        yoloé—´éš”.setRange(1, 10)
        yoloé—´éš”.setSuffix(" å¸§")
        yoloé—´éš”.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        yoloé—´éš”.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["YOLOæ£€æµ‹é—´éš”"] = yoloé—´éš”
        è¡¨å•å¸ƒå±€.addRow("æ£€æµ‹é—´éš”:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(yoloé—´éš”, "æ¯Nå¸§æ‰§è¡Œä¸€æ¬¡æ£€æµ‹ï¼Œå€¼è¶Šå¤§æ€§èƒ½è¶Šå¥½"))
        
        # çŠ¶æ€è¯†åˆ«å™¨åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜2 = QLabel("ğŸ” çŠ¶æ€è¯†åˆ«å™¨")
        åˆ†ç»„æ ‡é¢˜2.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 12px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜2)
        
        # çŠ¶æ€è¯†åˆ«å™¨å¼€å…³
        çŠ¶æ€è¯†åˆ«å¯ç”¨ = QCheckBox("å¯ç”¨çŠ¶æ€è¯†åˆ«")
        çŠ¶æ€è¯†åˆ«å¯ç”¨.setStyleSheet("QCheckBox { spacing: 8px; }")
        self._é…ç½®æ§ä»¶["çŠ¶æ€è¯†åˆ«å¯ç”¨"] = çŠ¶æ€è¯†åˆ«å¯ç”¨
        è¡¨å•å¸ƒå±€.addRow("", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(çŠ¶æ€è¯†åˆ«å¯ç”¨, "å¯ç”¨åå¯è¯†åˆ«å½“å‰æ¸¸æˆçŠ¶æ€ï¼ˆæˆ˜æ–—/å¯¹è¯ç­‰ï¼‰"))
        
        # å†³ç­–å¼•æ“åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜3 = QLabel("ğŸ§  å†³ç­–å¼•æ“")
        åˆ†ç»„æ ‡é¢˜3.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 12px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜3)
        
        # å†³ç­–å¼•æ“å¼€å…³
        å†³ç­–å¼•æ“å¯ç”¨ = QCheckBox("å¯ç”¨å†³ç­–å¼•æ“")
        å†³ç­–å¼•æ“å¯ç”¨.setStyleSheet("QCheckBox { spacing: 8px; }")
        self._é…ç½®æ§ä»¶["å†³ç­–å¼•æ“å¯ç”¨"] = å†³ç­–å¼•æ“å¯ç”¨
        è¡¨å•å¸ƒå±€.addRow("", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(å†³ç­–å¼•æ“å¯ç”¨, "å¯ç”¨åä½¿ç”¨è§„åˆ™+æ¨¡å‹æ··åˆå†³ç­–"))
        
        # å†³ç­–ç­–ç•¥é€‰æ‹©
        å†³ç­–ç­–ç•¥ = QComboBox()
        å†³ç­–ç­–ç•¥.addItems(["è§„åˆ™ä¼˜å…ˆ", "æ¨¡å‹ä¼˜å…ˆ", "æ··åˆåŠ æƒ"])
        å†³ç­–ç­–ç•¥.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        å†³ç­–ç­–ç•¥.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["å†³ç­–ç­–ç•¥"] = å†³ç­–ç­–ç•¥
        è¡¨å•å¸ƒå±€.addRow("å†³ç­–ç­–ç•¥:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(å†³ç­–ç­–ç•¥, "é€‰æ‹©å†³ç­–å¼•æ“çš„å·¥ä½œæ¨¡å¼"))
        
        # è§„åˆ™æƒé‡
        è§„åˆ™æƒé‡å®¹å™¨ = QWidget()
        è§„åˆ™æƒé‡å¸ƒå±€ = QHBoxLayout(è§„åˆ™æƒé‡å®¹å™¨)
        è§„åˆ™æƒé‡å¸ƒå±€.setContentsMargins(0, 0, 0, 0)
        è§„åˆ™æƒé‡å¸ƒå±€.setSpacing(8)
        
        è§„åˆ™æƒé‡æ»‘å— = QSlider(Qt.Horizontal)
        è§„åˆ™æƒé‡æ»‘å—.setRange(0, 100)
        è§„åˆ™æƒé‡æ»‘å—.setValue(60)
        è§„åˆ™æƒé‡æ»‘å—.setFixedWidth(100)
        
        è§„åˆ™æƒé‡æ ‡ç­¾ = QLabel("0.60")
        è§„åˆ™æƒé‡æ ‡ç­¾.setFixedWidth(40)
        
        def æ›´æ–°è§„åˆ™æƒé‡æ ‡ç­¾(å€¼):
            è§„åˆ™æƒé‡æ ‡ç­¾.setText(f"{å€¼/100:.2f}")
        
        è§„åˆ™æƒé‡æ»‘å—.valueChanged.connect(æ›´æ–°è§„åˆ™æƒé‡æ ‡ç­¾)
        
        è§„åˆ™æƒé‡å¸ƒå±€.addWidget(è§„åˆ™æƒé‡æ»‘å—)
        è§„åˆ™æƒé‡å¸ƒå±€.addWidget(è§„åˆ™æƒé‡æ ‡ç­¾)
        
        self._é…ç½®æ§ä»¶["è§„åˆ™æƒé‡"] = è§„åˆ™æƒé‡æ»‘å—
        è¡¨å•å¸ƒå±€.addRow("è§„åˆ™æƒé‡:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(è§„åˆ™æƒé‡å®¹å™¨, "æ··åˆæ¨¡å¼ä¸‹è§„åˆ™çš„æƒé‡ï¼ˆæ¨¡å‹æƒé‡=1-è§„åˆ™æƒé‡ï¼‰"))
        
        # æ€§èƒ½é…ç½®åˆ†ç»„
        åˆ†ç»„æ ‡é¢˜4 = QLabel("âš¡ æ€§èƒ½é…ç½®")
        åˆ†ç»„æ ‡é¢˜4.setStyleSheet(f"""
            font-size: {å¸ƒå±€å¸¸é‡.å¡ç‰‡æ ‡é¢˜å­—å·}px;
            font-weight: bold;
            color: {é¢œè‰².æ ‡é¢˜};
            padding: 12px 0 4px 0;
        """)
        è¡¨å•å¸ƒå±€.addRow(åˆ†ç»„æ ‡é¢˜4)
        
        # æ€§èƒ½é…ç½® - è‡ªåŠ¨é™çº§
        è‡ªåŠ¨é™çº§ = QCheckBox("å¯ç”¨è‡ªåŠ¨æ€§èƒ½é™çº§")
        è‡ªåŠ¨é™çº§.setStyleSheet("QCheckBox { spacing: 8px; }")
        self._é…ç½®æ§ä»¶["è‡ªåŠ¨é™çº§"] = è‡ªåŠ¨é™çº§
        è¡¨å•å¸ƒå±€.addRow("", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(è‡ªåŠ¨é™çº§, "å¸§ç‡è¿‡ä½æ—¶è‡ªåŠ¨é™ä½æ£€æµ‹é¢‘ç‡"))
        
        # å¸§ç‡é˜ˆå€¼
        å¸§ç‡é˜ˆå€¼ = QSpinBox()
        å¸§ç‡é˜ˆå€¼.setRange(5, 60)
        å¸§ç‡é˜ˆå€¼.setSuffix(" FPS")
        å¸§ç‡é˜ˆå€¼.setFixedWidth(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶æœ€å°å®½åº¦ + 40)
        å¸§ç‡é˜ˆå€¼.setFixedHeight(å¸ƒå±€å¸¸é‡.è¡¨å•æ§ä»¶é«˜åº¦)
        self._é…ç½®æ§ä»¶["å¸§ç‡é˜ˆå€¼"] = å¸§ç‡é˜ˆå€¼
        è¡¨å•å¸ƒå±€.addRow("å¸§ç‡é˜ˆå€¼:", self._åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(å¸§ç‡é˜ˆå€¼, "ä½äºæ­¤å¸§ç‡è¿›å…¥ä½æ€§èƒ½æ¨¡å¼"))
        
        return self._åˆ›å»ºæ ‡ç­¾é¡µå†…å®¹(è¡¨å•å¸ƒå±€)
    
    def _åˆ›å»ºåº•éƒ¨æŒ‰é’®åŒºåŸŸ(self) -> QWidget:
        """åˆ›å»ºåº•éƒ¨å›ºå®šçš„ä¿å­˜å’Œé‡ç½®æŒ‰é’®åŒºåŸŸ (Requirements 5.5)"""
        æŒ‰é’®å®¹å™¨ = QWidget()
        æŒ‰é’®å¸ƒå±€ = QHBoxLayout(æŒ‰é’®å®¹å™¨)
        æŒ‰é’®å¸ƒå±€.setContentsMargins(0, å¸ƒå±€å¸¸é‡.å¡ç‰‡é—´è·, 0, 0)
        æŒ‰é’®å¸ƒå±€.setSpacing(å¸ƒå±€å¸¸é‡.æŒ‰é’®é—´è·)
        
        æŒ‰é’®å¸ƒå±€.addStretch()
        
        # é‡ç½®æŒ‰é’®
        self._é‡ç½®æŒ‰é’® = QPushButton("ğŸ”„ é‡ç½®é»˜è®¤")
        self._é‡ç½®æŒ‰é’®.setFixedSize(100, å¸ƒå±€å¸¸é‡.æŒ‰é’®é«˜åº¦)
        self._é‡ç½®æŒ‰é’®.setStyleSheet(f"""
            QPushButton {{
                background-color: {é¢œè‰².å¡ç‰‡èƒŒæ™¯};
                color: {é¢œè‰².æ–‡å­—};
                border: 1px solid {é¢œè‰².è¾¹æ¡†};
                border-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                font-size: {å¸ƒå±€å¸¸é‡.æŒ‰é’®æ–‡å­—å­—å·}px;
                padding: 0 {å¸ƒå±€å¸¸é‡.æŒ‰é’®æ°´å¹³å†…è¾¹è·}px;
            }}
            QPushButton:hover {{
                background-color: {é¢œè‰².æ‚¬åœèƒŒæ™¯};
            }}
        """)
        self._é‡ç½®æŒ‰é’®.clicked.connect(self._é‡ç½®é…ç½®)
        æŒ‰é’®å¸ƒå±€.addWidget(self._é‡ç½®æŒ‰é’®)
        
        # ä¿å­˜æŒ‰é’®
        self._ä¿å­˜æŒ‰é’® = QPushButton("ğŸ’¾ ä¿å­˜é…ç½®")
        self._ä¿å­˜æŒ‰é’®.setFixedSize(100, å¸ƒå±€å¸¸é‡.æŒ‰é’®é«˜åº¦)
        self._ä¿å­˜æŒ‰é’®.setStyleSheet(f"""
            QPushButton {{
                background-color: {é¢œè‰².ä¸»è‰²};
                color: white;
                border: none;
                border-radius: {å¸ƒå±€å¸¸é‡.æŒ‰é’®åœ†è§’}px;
                font-size: {å¸ƒå±€å¸¸é‡.æŒ‰é’®æ–‡å­—å­—å·}px;
                font-weight: bold;
                padding: 0 {å¸ƒå±€å¸¸é‡.æŒ‰é’®æ°´å¹³å†…è¾¹è·}px;
            }}
            QPushButton:hover {{
                background-color: #2563EB;
            }}
        """)
        self._ä¿å­˜æŒ‰é’®.clicked.connect(self._ä¿å­˜é…ç½®)
        æŒ‰é’®å¸ƒå±€.addWidget(self._ä¿å­˜æŒ‰é’®)
        
        return æŒ‰é’®å®¹å™¨
    
    def _åˆ›å»ºå¸¦è¯´æ˜çš„æ§ä»¶(self, æ§ä»¶: QWidget, è¯´æ˜: str) -> QWidget:
        """åˆ›å»ºå¸¦è¯´æ˜æ–‡å­—çš„æ§ä»¶å®¹å™¨"""
        å®¹å™¨ = QWidget()
        å¸ƒå±€ = QVBoxLayout(å®¹å™¨)
        å¸ƒå±€.setContentsMargins(0, 0, 0, 0)
        å¸ƒå±€.setSpacing(2)
        
        å¸ƒå±€.addWidget(æ§ä»¶)
        
        è¯´æ˜æ ‡ç­¾ = QLabel(è¯´æ˜)
        è¯´æ˜æ ‡ç­¾.setStyleSheet(f"""
            color: {é¢œè‰².æ¬¡è¦æ–‡å­—};
            font-size: {å¸ƒå±€å¸¸é‡.æ¬¡è¦æ–‡å­—å­—å·}px;
        """)
        è¯´æ˜æ ‡ç­¾.setWordWrap(True)
        å¸ƒå±€.addWidget(è¯´æ˜æ ‡ç­¾)
        
        return å®¹å™¨
    
    # ==================== æ¡£æ¡ˆç®¡ç†æ–¹æ³• ====================
    
    def _åˆ·æ–°æ¡£æ¡ˆåˆ—è¡¨(self):
        """åˆ·æ–°æ¡£æ¡ˆåˆ—è¡¨"""
        if not self._é…ç½®ç®¡ç†å™¨:
            return
        
        # ä¿å­˜å½“å‰é€‰æ‹©
        å½“å‰é€‰æ‹© = self._æ¡£æ¡ˆé€‰æ‹©.currentText()
        
        # é˜»æ­¢ä¿¡å·è§¦å‘
        self._æ¡£æ¡ˆé€‰æ‹©.blockSignals(True)
        
        # æ¸…ç©ºå¹¶é‡æ–°åŠ è½½
        self._æ¡£æ¡ˆé€‰æ‹©.clear()
        æ¡£æ¡ˆåˆ—è¡¨ = self._é…ç½®ç®¡ç†å™¨.list_profiles()
        
        if æ¡£æ¡ˆåˆ—è¡¨:
            self._æ¡£æ¡ˆé€‰æ‹©.addItems(æ¡£æ¡ˆåˆ—è¡¨)
            
            # æ¢å¤é€‰æ‹©æˆ–é€‰æ‹©å½“å‰æ¡£æ¡ˆ
            å½“å‰æ¡£æ¡ˆ = self._é…ç½®ç®¡ç†å™¨.get_current_profile()
            if å½“å‰æ¡£æ¡ˆ and å½“å‰æ¡£æ¡ˆ.name in æ¡£æ¡ˆåˆ—è¡¨:
                self._æ¡£æ¡ˆé€‰æ‹©.setCurrentText(å½“å‰æ¡£æ¡ˆ.name)
            elif å½“å‰é€‰æ‹© in æ¡£æ¡ˆåˆ—è¡¨:
                self._æ¡£æ¡ˆé€‰æ‹©.setCurrentText(å½“å‰é€‰æ‹©)
        else:
            self._æ¡£æ¡ˆé€‰æ‹©.addItem("(æ— æ¡£æ¡ˆ)")
        
        # æ¢å¤ä¿¡å·
        self._æ¡£æ¡ˆé€‰æ‹©.blockSignals(False)
    
    def _åˆ‡æ¢æ¡£æ¡ˆ(self, æ¡£æ¡ˆåç§°: str):
        """åˆ‡æ¢é…ç½®æ¡£æ¡ˆ (éœ€æ±‚ 6.1)"""
        if not self._é…ç½®ç®¡ç†å™¨ or not æ¡£æ¡ˆåç§° or æ¡£æ¡ˆåç§° == "(æ— æ¡£æ¡ˆ)":
            return
        
        try:
            self._é…ç½®ç®¡ç†å™¨.switch_profile(æ¡£æ¡ˆåç§°)
            self.æ¡£æ¡ˆå·²åˆ‡æ¢.emit(æ¡£æ¡ˆåç§°)
        except FileNotFoundError:
            QMessageBox.warning(self, "åˆ‡æ¢å¤±è´¥", f"æ¡£æ¡ˆ '{æ¡£æ¡ˆåç§°}' ä¸å­˜åœ¨")
        except Exception as e:
            QMessageBox.warning(self, "åˆ‡æ¢å¤±è´¥", f"åˆ‡æ¢æ¡£æ¡ˆæ—¶å‘ç”Ÿé”™è¯¯:\n{str(e)}")
    
    def _æ–°å»ºæ¡£æ¡ˆ(self):
        """æ–°å»ºé…ç½®æ¡£æ¡ˆ"""
        if not self._é…ç½®ç®¡ç†å™¨:
            QMessageBox.warning(self, "é”™è¯¯", "é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–")
            return
        
        # è·å–æ¡£æ¡ˆåç§°
        æ¡£æ¡ˆåç§°, ç¡®è®¤ = QInputDialog.getText(
            self, "æ–°å»ºæ¡£æ¡ˆ", "è¯·è¾“å…¥æ¡£æ¡ˆåç§°:",
            QLineEdit.Normal, ""
        )
        
        if not ç¡®è®¤ or not æ¡£æ¡ˆåç§°.strip():
            return
        
        # è·å–æ¸¸æˆåç§°
        æ¸¸æˆåç§°, ç¡®è®¤ = QInputDialog.getText(
            self, "æ–°å»ºæ¡£æ¡ˆ", "è¯·è¾“å…¥æ¸¸æˆåç§°:",
            QLineEdit.Normal, "æœªå‘½åæ¸¸æˆ"
        )
        
        if not ç¡®è®¤:
            return
        
        æ¸¸æˆåç§° = æ¸¸æˆåç§°.strip() or "æœªå‘½åæ¸¸æˆ"
        
        try:
            # åˆ›å»ºæ–°æ¡£æ¡ˆ
            æ–°æ¡£æ¡ˆ = self._é…ç½®ç®¡ç†å™¨.create_profile(æ¡£æ¡ˆåç§°.strip(), æ¸¸æˆåç§°)
            # ä¿å­˜æ¡£æ¡ˆ
            self._é…ç½®ç®¡ç†å™¨.save_profile(æ–°æ¡£æ¡ˆ)
            # åˆ·æ–°åˆ—è¡¨
            self._åˆ·æ–°æ¡£æ¡ˆåˆ—è¡¨()
            # é€‰æ‹©æ–°æ¡£æ¡ˆ
            self._æ¡£æ¡ˆé€‰æ‹©.setCurrentText(æ¡£æ¡ˆåç§°.strip())
            
            QMessageBox.information(self, "æˆåŠŸ", f"æ¡£æ¡ˆ '{æ¡£æ¡ˆåç§°}' åˆ›å»ºæˆåŠŸï¼")
        except FileExistsError:
            QMessageBox.warning(self, "åˆ›å»ºå¤±è´¥", f"æ¡£æ¡ˆ '{æ¡£æ¡ˆåç§°}' å·²å­˜åœ¨")
        except Exception as e:
            QMessageBox.warning(self, "åˆ›å»ºå¤±è´¥", f"åˆ›å»ºæ¡£æ¡ˆæ—¶å‘ç”Ÿé”™è¯¯:\n{str(e)}")
    
    def _å¯¼å…¥æ¡£æ¡ˆ(self):
        """å¯¼å…¥é…ç½®æ¡£æ¡ˆ (éœ€æ±‚ 6.5)"""
        if not self._é…ç½®ç®¡ç†å™¨:
            QMessageBox.warning(self, "é”™è¯¯", "é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–")
            return
        
        # é€‰æ‹©æ–‡ä»¶
        æ–‡ä»¶è·¯å¾„, _ = QFileDialog.getOpenFileName(
            self, "å¯¼å…¥é…ç½®æ¡£æ¡ˆ", "",
            "JSONæ–‡ä»¶ (*.json);;æ‰€æœ‰æ–‡ä»¶ (*.*)"
        )
        
        if not æ–‡ä»¶è·¯å¾„:
            return
        
        # è¯¢é—®æ˜¯å¦ä½¿ç”¨æ–°åç§°
        æ–°åç§°, ç¡®è®¤ = QInputDialog.getText(
            self, "å¯¼å…¥æ¡£æ¡ˆ", 
            "è¯·è¾“å…¥å¯¼å…¥åçš„æ¡£æ¡ˆåç§° (ç•™ç©ºä½¿ç”¨åŸåç§°):",
            QLineEdit.Normal, ""
        )
        
        if not ç¡®è®¤:
            return
        
        try:
            # å¯¼å…¥æ¡£æ¡ˆ
            å¯¼å…¥çš„æ¡£æ¡ˆ = self._é…ç½®ç®¡ç†å™¨.import_profile(
                æ–‡ä»¶è·¯å¾„, 
                æ–°åç§°.strip() if æ–°åç§°.strip() else None
            )
            # ä¿å­˜æ¡£æ¡ˆ
            self._é…ç½®ç®¡ç†å™¨.save_profile(å¯¼å…¥çš„æ¡£æ¡ˆ)
            # åˆ·æ–°åˆ—è¡¨
            self._åˆ·æ–°æ¡£æ¡ˆåˆ—è¡¨()
            # é€‰æ‹©å¯¼å…¥çš„æ¡£æ¡ˆ
            self._æ¡£æ¡ˆé€‰æ‹©.setCurrentText(å¯¼å…¥çš„æ¡£æ¡ˆ.name)
            
            QMessageBox.information(self, "æˆåŠŸ", f"æ¡£æ¡ˆ '{å¯¼å…¥çš„æ¡£æ¡ˆ.name}' å¯¼å…¥æˆåŠŸï¼")
        except FileExistsError:
            QMessageBox.warning(self, "å¯¼å…¥å¤±è´¥", "åŒåæ¡£æ¡ˆå·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–åç§°")
        except ValueError as e:
            QMessageBox.warning(self, "å¯¼å…¥å¤±è´¥", f"æ–‡ä»¶æ ¼å¼æ— æ•ˆ:\n{str(e)}")
        except Exception as e:
            QMessageBox.warning(self, "å¯¼å…¥å¤±è´¥", f"å¯¼å…¥æ¡£æ¡ˆæ—¶å‘ç”Ÿé”™è¯¯:\n{str(e)}")
    
    def _å¯¼å‡ºæ¡£æ¡ˆ(self):
        """å¯¼å‡ºé…ç½®æ¡£æ¡ˆ (éœ€æ±‚ 6.3)"""
        if not self._é…ç½®ç®¡ç†å™¨:
            QMessageBox.warning(self, "é”™è¯¯", "é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–")
            return
        
        å½“å‰æ¡£æ¡ˆå = self._æ¡£æ¡ˆé€‰æ‹©.currentText()
        if not å½“å‰æ¡£æ¡ˆå or å½“å‰æ¡£æ¡ˆå == "(æ— æ¡£æ¡ˆ)":
            QMessageBox.warning(self, "å¯¼å‡ºå¤±è´¥", "è¯·å…ˆé€‰æ‹©è¦å¯¼å‡ºçš„æ¡£æ¡ˆ")
            return
        
        # é€‰æ‹©ä¿å­˜è·¯å¾„
        æ–‡ä»¶è·¯å¾„, _ = QFileDialog.getSaveFileName(
            self, "å¯¼å‡ºé…ç½®æ¡£æ¡ˆ", f"{å½“å‰æ¡£æ¡ˆå}.json",
            "JSONæ–‡ä»¶ (*.json);;æ‰€æœ‰æ–‡ä»¶ (*.*)"
        )
        
        if not æ–‡ä»¶è·¯å¾„:
            return
        
        try:
            self._é…ç½®ç®¡ç†å™¨.export_profile(å½“å‰æ¡£æ¡ˆå, æ–‡ä»¶è·¯å¾„)
            QMessageBox.information(self, "æˆåŠŸ", f"æ¡£æ¡ˆå·²å¯¼å‡ºåˆ°:\n{æ–‡ä»¶è·¯å¾„}")
        except FileNotFoundError:
            QMessageBox.warning(self, "å¯¼å‡ºå¤±è´¥", f"æ¡£æ¡ˆ '{å½“å‰æ¡£æ¡ˆå}' ä¸å­˜åœ¨")
        except Exception as e:
            QMessageBox.warning(self, "å¯¼å‡ºå¤±è´¥", f"å¯¼å‡ºæ¡£æ¡ˆæ—¶å‘ç”Ÿé”™è¯¯:\n{str(e)}")
    
    def _åˆ é™¤æ¡£æ¡ˆ(self):
        """åˆ é™¤é…ç½®æ¡£æ¡ˆ"""
        if not self._é…ç½®ç®¡ç†å™¨:
            QMessageBox.warning(self, "é”™è¯¯", "é…ç½®ç®¡ç†å™¨æœªåˆå§‹åŒ–")
            return
        
        å½“å‰æ¡£æ¡ˆå = self._æ¡£æ¡ˆé€‰æ‹©.currentText()
        if not å½“å‰æ¡£æ¡ˆå or å½“å‰æ¡£æ¡ˆå == "(æ— æ¡£æ¡ˆ)":
            QMessageBox.warning(self, "åˆ é™¤å¤±è´¥", "è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„æ¡£æ¡ˆ")
            return
        
        # ç¡®è®¤åˆ é™¤
        å›å¤ = QMessageBox.question(
            self, "ç¡®è®¤åˆ é™¤",
            f"ç¡®å®šè¦åˆ é™¤æ¡£æ¡ˆ '{å½“å‰æ¡£æ¡ˆå}' å—ï¼Ÿ\næ­¤æ“ä½œä¸å¯æ’¤é”€ï¼",
            QMessageBox.Yes | QMessageBox.No,
            QMessageBox.No
        )
        
        if å›å¤ != QMessageBox.Yes:
            return
        
        try:
            self._é…ç½®ç®¡ç†å™¨.delete_profile(å½“å‰æ¡£æ¡ˆå)
            self._åˆ·æ–°æ¡£æ¡ˆåˆ—è¡¨()
            QMessageBox.information(self, "æˆåŠŸ", f"æ¡£æ¡ˆ '{å½“å‰æ¡£æ¡ˆå}' å·²åˆ é™¤")
        except FileNotFoundError:
            QMessageBox.warning(self, "åˆ é™¤å¤±è´¥", f"æ¡£æ¡ˆ '{å½“å‰æ¡£æ¡ˆå}' ä¸å­˜åœ¨")
        except Exception as e:
            QMessageBox.warning(self, "åˆ é™¤å¤±è´¥", f"åˆ é™¤æ¡£æ¡ˆæ—¶å‘ç”Ÿé”™è¯¯:\n{str(e)}")

    # ==================== é…ç½®åŠ è½½å’Œä¿å­˜æ–¹æ³• ====================
    
    def _åŠ è½½é…ç½®(self):
        """ä»é…ç½®æ–‡ä»¶åŠ è½½é…ç½®å€¼åˆ°æ§ä»¶"""
        try:
            # å¯¼å…¥é…ç½®æ¨¡å—
            from é…ç½® import è®¾ç½®
            from é…ç½® import å¢å¼ºè®¾ç½®
            
            # æ¸¸æˆçª—å£é…ç½®
            çª—å£åŒºåŸŸ = getattr(è®¾ç½®, 'æ¸¸æˆçª—å£åŒºåŸŸ', (0, 40, 1920, 1120))
            self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å·¦"].setValue(çª—å£åŒºåŸŸ[0])
            self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸Š"].setValue(çª—å£åŒºåŸŸ[1])
            self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å³"].setValue(çª—å£åŒºåŸŸ[2])
            self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸‹"].setValue(çª—å£åŒºåŸŸ[3])
            
            self._é…ç½®æ§ä»¶["æ¸¸æˆå®½åº¦"].setValue(getattr(è®¾ç½®, 'æ¸¸æˆå®½åº¦', 1920))
            self._é…ç½®æ§ä»¶["æ¸¸æˆé«˜åº¦"].setValue(getattr(è®¾ç½®, 'æ¸¸æˆé«˜åº¦', 1080))
            
            # æ¨¡å‹é…ç½®
            self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥å®½åº¦"].setValue(getattr(è®¾ç½®, 'æ¨¡å‹è¾“å…¥å®½åº¦', 480))
            self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥é«˜åº¦"].setValue(getattr(è®¾ç½®, 'æ¨¡å‹è¾“å…¥é«˜åº¦', 270))
            self._é…ç½®æ§ä»¶["æ¨¡å‹ä¿å­˜è·¯å¾„"].setText(getattr(è®¾ç½®, 'æ¨¡å‹ä¿å­˜è·¯å¾„', 'æ¨¡å‹/æ¸¸æˆAI'))
            self._é…ç½®æ§ä»¶["é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„"].setText(getattr(è®¾ç½®, 'é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„', 'æ¨¡å‹/é¢„è®­ç»ƒæ¨¡å‹/test'))
            
            # è®­ç»ƒé…ç½®
            å­¦ä¹ ç‡å€¼ = getattr(è®¾ç½®, 'å­¦ä¹ ç‡', 0.001)
            self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡"].setValue(å­¦ä¹ ç‡å€¼)
            self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡_æ»‘å—"].setValue(int(å­¦ä¹ ç‡å€¼ * 10000))
            
            self._é…ç½®æ§ä»¶["è®­ç»ƒè½®æ•°"].setValue(getattr(è®¾ç½®, 'è®­ç»ƒè½®æ•°', 10))
            self._é…ç½®æ§ä»¶["æ¯æ–‡ä»¶æ ·æœ¬æ•°"].setValue(getattr(è®¾ç½®, 'æ¯æ–‡ä»¶æ ·æœ¬æ•°', 500))
            self._é…ç½®æ§ä»¶["æ•°æ®ä¿å­˜è·¯å¾„"].setText(getattr(è®¾ç½®, 'æ•°æ®ä¿å­˜è·¯å¾„', 'æ•°æ®/'))
            self._é…ç½®æ§ä»¶["è¿åŠ¨æ£€æµ‹é˜ˆå€¼"].setValue(getattr(è®¾ç½®, 'è¿åŠ¨æ£€æµ‹é˜ˆå€¼', 800))
            
            # å¢å¼ºæ¨¡å—é…ç½®
            yoloé…ç½® = getattr(å¢å¼ºè®¾ç½®, 'YOLOé…ç½®', {})
            self._é…ç½®æ§ä»¶["YOLOå¯ç”¨"].setChecked(yoloé…ç½®.get('å¯ç”¨', True))
            self._é…ç½®æ§ä»¶["YOLOç½®ä¿¡åº¦"].setValue(int(yoloé…ç½®.get('ç½®ä¿¡åº¦é˜ˆå€¼', 0.5) * 100))
            self._é…ç½®æ§ä»¶["YOLOæ£€æµ‹é—´éš”"].setValue(yoloé…ç½®.get('æ£€æµ‹é—´éš”', 3))
            
            çŠ¶æ€é…ç½® = getattr(å¢å¼ºè®¾ç½®, 'çŠ¶æ€è¯†åˆ«é…ç½®', {})
            self._é…ç½®æ§ä»¶["çŠ¶æ€è¯†åˆ«å¯ç”¨"].setChecked(çŠ¶æ€é…ç½®.get('å¯ç”¨', True))
            
            å†³ç­–é…ç½® = getattr(å¢å¼ºè®¾ç½®, 'å†³ç­–å¼•æ“é…ç½®', {})
            self._é…ç½®æ§ä»¶["å†³ç­–å¼•æ“å¯ç”¨"].setChecked(å†³ç­–é…ç½®.get('å¯ç”¨', True))
            
            # å†³ç­–ç­–ç•¥
            ç­–ç•¥æ˜ å°„ = {
                å¢å¼ºè®¾ç½®.å†³ç­–ç­–ç•¥æšä¸¾.è§„åˆ™ä¼˜å…ˆ: 0,
                å¢å¼ºè®¾ç½®.å†³ç­–ç­–ç•¥æšä¸¾.æ¨¡å‹ä¼˜å…ˆ: 1,
                å¢å¼ºè®¾ç½®.å†³ç­–ç­–ç•¥æšä¸¾.æ··åˆåŠ æƒ: 2,
            }
            å½“å‰ç­–ç•¥ = å†³ç­–é…ç½®.get('ç­–ç•¥', å¢å¼ºè®¾ç½®.å†³ç­–ç­–ç•¥æšä¸¾.æ··åˆåŠ æƒ)
            self._é…ç½®æ§ä»¶["å†³ç­–ç­–ç•¥"].setCurrentIndex(ç­–ç•¥æ˜ å°„.get(å½“å‰ç­–ç•¥, 2))
            
            self._é…ç½®æ§ä»¶["è§„åˆ™æƒé‡"].setValue(int(å†³ç­–é…ç½®.get('è§„åˆ™æƒé‡', 0.6) * 100))
            
            æ€§èƒ½é…ç½® = getattr(å¢å¼ºè®¾ç½®, 'æ€§èƒ½é…ç½®', {})
            self._é…ç½®æ§ä»¶["è‡ªåŠ¨é™çº§"].setChecked(æ€§èƒ½é…ç½®.get('è‡ªåŠ¨é™çº§', True))
            self._é…ç½®æ§ä»¶["å¸§ç‡é˜ˆå€¼"].setValue(æ€§èƒ½é…ç½®.get('å¸§ç‡é˜ˆå€¼', 15))
            
            # ä¿å­˜åŸå§‹å€¼ç”¨äºé‡ç½®
            self._ä¿å­˜åŸå§‹å€¼()
            
        except Exception as e:
            print(f"åŠ è½½é…ç½®å¤±è´¥: {e}")
            # ä½¿ç”¨é»˜è®¤å€¼
            self._ä½¿ç”¨é»˜è®¤å€¼()
    
    def _ä½¿ç”¨é»˜è®¤å€¼(self):
        """ä½¿ç”¨é»˜è®¤é…ç½®å€¼"""
        # æ¸¸æˆçª—å£é»˜è®¤å€¼
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å·¦"].setValue(0)
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸Š"].setValue(40)
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å³"].setValue(1920)
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸‹"].setValue(1120)
        self._é…ç½®æ§ä»¶["æ¸¸æˆå®½åº¦"].setValue(1920)
        self._é…ç½®æ§ä»¶["æ¸¸æˆé«˜åº¦"].setValue(1080)
        
        # æ¨¡å‹é»˜è®¤å€¼
        self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥å®½åº¦"].setValue(480)
        self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥é«˜åº¦"].setValue(270)
        self._é…ç½®æ§ä»¶["æ¨¡å‹ä¿å­˜è·¯å¾„"].setText("æ¨¡å‹/æ¸¸æˆAI")
        self._é…ç½®æ§ä»¶["é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„"].setText("æ¨¡å‹/é¢„è®­ç»ƒæ¨¡å‹/test")
        
        # è®­ç»ƒé»˜è®¤å€¼
        self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡"].setValue(0.001)
        self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡_æ»‘å—"].setValue(10)
        self._é…ç½®æ§ä»¶["è®­ç»ƒè½®æ•°"].setValue(10)
        self._é…ç½®æ§ä»¶["æ¯æ–‡ä»¶æ ·æœ¬æ•°"].setValue(500)
        self._é…ç½®æ§ä»¶["æ•°æ®ä¿å­˜è·¯å¾„"].setText("æ•°æ®/")
        self._é…ç½®æ§ä»¶["è¿åŠ¨æ£€æµ‹é˜ˆå€¼"].setValue(800)
        
        # å¢å¼ºæ¨¡å—é»˜è®¤å€¼
        self._é…ç½®æ§ä»¶["YOLOå¯ç”¨"].setChecked(True)
        self._é…ç½®æ§ä»¶["YOLOç½®ä¿¡åº¦"].setValue(50)
        self._é…ç½®æ§ä»¶["YOLOæ£€æµ‹é—´éš”"].setValue(3)
        self._é…ç½®æ§ä»¶["çŠ¶æ€è¯†åˆ«å¯ç”¨"].setChecked(True)
        self._é…ç½®æ§ä»¶["å†³ç­–å¼•æ“å¯ç”¨"].setChecked(True)
        self._é…ç½®æ§ä»¶["å†³ç­–ç­–ç•¥"].setCurrentIndex(2)
        self._é…ç½®æ§ä»¶["è§„åˆ™æƒé‡"].setValue(60)
        self._é…ç½®æ§ä»¶["è‡ªåŠ¨é™çº§"].setChecked(True)
        self._é…ç½®æ§ä»¶["å¸§ç‡é˜ˆå€¼"].setValue(15)
        
        self._ä¿å­˜åŸå§‹å€¼()
    
    def _ä¿å­˜åŸå§‹å€¼(self):
        """ä¿å­˜å½“å‰æ§ä»¶å€¼ä½œä¸ºåŸå§‹å€¼"""
        self._åŸå§‹å€¼ = self._è·å–å½“å‰é…ç½®()
    
    def _è·å–å½“å‰é…ç½®(self) -> dict:
        """è·å–å½“å‰æ‰€æœ‰é…ç½®å€¼"""
        return {
            # æ¸¸æˆçª—å£
            "æ¸¸æˆçª—å£_å·¦": self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å·¦"].value(),
            "æ¸¸æˆçª—å£_ä¸Š": self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸Š"].value(),
            "æ¸¸æˆçª—å£_å³": self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å³"].value(),
            "æ¸¸æˆçª—å£_ä¸‹": self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸‹"].value(),
            "æ¸¸æˆå®½åº¦": self._é…ç½®æ§ä»¶["æ¸¸æˆå®½åº¦"].value(),
            "æ¸¸æˆé«˜åº¦": self._é…ç½®æ§ä»¶["æ¸¸æˆé«˜åº¦"].value(),
            # æ¨¡å‹
            "æ¨¡å‹è¾“å…¥å®½åº¦": self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥å®½åº¦"].value(),
            "æ¨¡å‹è¾“å…¥é«˜åº¦": self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥é«˜åº¦"].value(),
            "æ¨¡å‹ä¿å­˜è·¯å¾„": self._é…ç½®æ§ä»¶["æ¨¡å‹ä¿å­˜è·¯å¾„"].text(),
            "é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„": self._é…ç½®æ§ä»¶["é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„"].text(),
            # è®­ç»ƒ
            "å­¦ä¹ ç‡": self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡"].value(),
            "è®­ç»ƒè½®æ•°": self._é…ç½®æ§ä»¶["è®­ç»ƒè½®æ•°"].value(),
            "æ¯æ–‡ä»¶æ ·æœ¬æ•°": self._é…ç½®æ§ä»¶["æ¯æ–‡ä»¶æ ·æœ¬æ•°"].value(),
            "æ•°æ®ä¿å­˜è·¯å¾„": self._é…ç½®æ§ä»¶["æ•°æ®ä¿å­˜è·¯å¾„"].text(),
            "è¿åŠ¨æ£€æµ‹é˜ˆå€¼": self._é…ç½®æ§ä»¶["è¿åŠ¨æ£€æµ‹é˜ˆå€¼"].value(),
            # å¢å¼ºæ¨¡å—
            "YOLOå¯ç”¨": self._é…ç½®æ§ä»¶["YOLOå¯ç”¨"].isChecked(),
            "YOLOç½®ä¿¡åº¦": self._é…ç½®æ§ä»¶["YOLOç½®ä¿¡åº¦"].value() / 100,
            "YOLOæ£€æµ‹é—´éš”": self._é…ç½®æ§ä»¶["YOLOæ£€æµ‹é—´éš”"].value(),
            "çŠ¶æ€è¯†åˆ«å¯ç”¨": self._é…ç½®æ§ä»¶["çŠ¶æ€è¯†åˆ«å¯ç”¨"].isChecked(),
            "å†³ç­–å¼•æ“å¯ç”¨": self._é…ç½®æ§ä»¶["å†³ç­–å¼•æ“å¯ç”¨"].isChecked(),
            "å†³ç­–ç­–ç•¥": self._é…ç½®æ§ä»¶["å†³ç­–ç­–ç•¥"].currentIndex(),
            "è§„åˆ™æƒé‡": self._é…ç½®æ§ä»¶["è§„åˆ™æƒé‡"].value() / 100,
            "è‡ªåŠ¨é™çº§": self._é…ç½®æ§ä»¶["è‡ªåŠ¨é™çº§"].isChecked(),
            "å¸§ç‡é˜ˆå€¼": self._é…ç½®æ§ä»¶["å¸§ç‡é˜ˆå€¼"].value(),
        }

    def _éªŒè¯é…ç½®(self) -> tuple:
        """
        éªŒè¯å½“å‰é…ç½®å€¼çš„æœ‰æ•ˆæ€§
        
        è¿”å›:
            (æ˜¯å¦æœ‰æ•ˆ, é”™è¯¯ä¿¡æ¯åˆ—è¡¨)
        """
        é”™è¯¯åˆ—è¡¨ = []
        é…ç½® = self._è·å–å½“å‰é…ç½®()
        
        # éªŒè¯æ¸¸æˆçª—å£åŒºåŸŸ
        if é…ç½®["æ¸¸æˆçª—å£_å·¦"] >= é…ç½®["æ¸¸æˆçª—å£_å³"]:
            é”™è¯¯åˆ—è¡¨.append("æ¸¸æˆçª—å£: å·¦è¾¹ç•Œå¿…é¡»å°äºå³è¾¹ç•Œ")
        
        if é…ç½®["æ¸¸æˆçª—å£_ä¸Š"] >= é…ç½®["æ¸¸æˆçª—å£_ä¸‹"]:
            é”™è¯¯åˆ—è¡¨.append("æ¸¸æˆçª—å£: ä¸Šè¾¹ç•Œå¿…é¡»å°äºä¸‹è¾¹ç•Œ")
        
        # éªŒè¯åˆ†è¾¨ç‡
        çª—å£å®½åº¦ = é…ç½®["æ¸¸æˆçª—å£_å³"] - é…ç½®["æ¸¸æˆçª—å£_å·¦"]
        çª—å£é«˜åº¦ = é…ç½®["æ¸¸æˆçª—å£_ä¸‹"] - é…ç½®["æ¸¸æˆçª—å£_ä¸Š"]
        
        if çª—å£å®½åº¦ < 640:
            é”™è¯¯åˆ—è¡¨.append("æ¸¸æˆçª—å£: å®½åº¦ä¸èƒ½å°äº640åƒç´ ")
        
        if çª—å£é«˜åº¦ < 480:
            é”™è¯¯åˆ—è¡¨.append("æ¸¸æˆçª—å£: é«˜åº¦ä¸èƒ½å°äº480åƒç´ ")
        
        # éªŒè¯æ¨¡å‹è¾“å…¥å°ºå¯¸
        if é…ç½®["æ¨¡å‹è¾“å…¥å®½åº¦"] > é…ç½®["æ¸¸æˆå®½åº¦"]:
            é”™è¯¯åˆ—è¡¨.append("æ¨¡å‹è¾“å…¥å®½åº¦ä¸èƒ½å¤§äºæ¸¸æˆå®½åº¦")
        
        if é…ç½®["æ¨¡å‹è¾“å…¥é«˜åº¦"] > é…ç½®["æ¸¸æˆé«˜åº¦"]:
            é”™è¯¯åˆ—è¡¨.append("æ¨¡å‹è¾“å…¥é«˜åº¦ä¸èƒ½å¤§äºæ¸¸æˆé«˜åº¦")
        
        # éªŒè¯è·¯å¾„
        if not é…ç½®["æ¨¡å‹ä¿å­˜è·¯å¾„"].strip():
            é”™è¯¯åˆ—è¡¨.append("æ¨¡å‹ä¿å­˜è·¯å¾„ä¸èƒ½ä¸ºç©º")
        
        if not é…ç½®["æ•°æ®ä¿å­˜è·¯å¾„"].strip():
            é”™è¯¯åˆ—è¡¨.append("æ•°æ®ä¿å­˜è·¯å¾„ä¸èƒ½ä¸ºç©º")
        
        # éªŒè¯å­¦ä¹ ç‡
        if é…ç½®["å­¦ä¹ ç‡"] <= 0:
            é”™è¯¯åˆ—è¡¨.append("å­¦ä¹ ç‡å¿…é¡»å¤§äº0")
        
        # éªŒè¯æƒé‡
        if not (0 <= é…ç½®["è§„åˆ™æƒé‡"] <= 1):
            é”™è¯¯åˆ—è¡¨.append("è§„åˆ™æƒé‡å¿…é¡»åœ¨0åˆ°1ä¹‹é—´")
        
        return len(é”™è¯¯åˆ—è¡¨) == 0, é”™è¯¯åˆ—è¡¨
    
    def _ä¿å­˜é…ç½®(self):
        """ä¿å­˜é…ç½®åˆ°æ–‡ä»¶"""
        # å…ˆéªŒè¯é…ç½®
        æœ‰æ•ˆ, é”™è¯¯åˆ—è¡¨ = self._éªŒè¯é…ç½®()
        
        if not æœ‰æ•ˆ:
            é”™è¯¯ä¿¡æ¯ = "\n".join(f"â€¢ {é”™è¯¯}" for é”™è¯¯ in é”™è¯¯åˆ—è¡¨)
            QMessageBox.warning(
                self,
                "é…ç½®éªŒè¯å¤±è´¥",
                f"ä»¥ä¸‹é…ç½®é¡¹å­˜åœ¨é—®é¢˜:\n\n{é”™è¯¯ä¿¡æ¯}",
                QMessageBox.Ok
            )
            return
        
        try:
            é…ç½® = self._è·å–å½“å‰é…ç½®()
            
            # ç”Ÿæˆè®¾ç½®.pyå†…å®¹
            è®¾ç½®å†…å®¹ = self._ç”Ÿæˆè®¾ç½®æ–‡ä»¶å†…å®¹(é…ç½®)
            
            # å†™å…¥è®¾ç½®.py
            with open("é…ç½®/è®¾ç½®.py", "w", encoding="utf-8") as f:
                f.write(è®¾ç½®å†…å®¹)
            
            # ç”Ÿæˆå¢å¼ºè®¾ç½®.pyå†…å®¹
            å¢å¼ºè®¾ç½®å†…å®¹ = self._ç”Ÿæˆå¢å¼ºè®¾ç½®æ–‡ä»¶å†…å®¹(é…ç½®)
            
            # å†™å…¥å¢å¼ºè®¾ç½®.py
            with open("é…ç½®/å¢å¼ºè®¾ç½®.py", "w", encoding="utf-8") as f:
                f.write(å¢å¼ºè®¾ç½®å†…å®¹)
            
            # æ›´æ–°åŸå§‹å€¼
            self._ä¿å­˜åŸå§‹å€¼()
            
            # å‘é€ä¿¡å·
            self.é…ç½®å·²ä¿å­˜.emit()
            
            QMessageBox.information(
                self,
                "ä¿å­˜æˆåŠŸ",
                "é…ç½®å·²æˆåŠŸä¿å­˜ï¼\n\néƒ¨åˆ†é…ç½®å¯èƒ½éœ€è¦é‡å¯ç¨‹åºåç”Ÿæ•ˆã€‚",
                QMessageBox.Ok
            )
            
        except Exception as e:
            QMessageBox.critical(
                self,
                "ä¿å­˜å¤±è´¥",
                f"ä¿å­˜é…ç½®æ—¶å‘ç”Ÿé”™è¯¯:\n\n{str(e)}",
                QMessageBox.Ok
            )
    
    def _é‡ç½®é…ç½®(self):
        """é‡ç½®é…ç½®åˆ°åŸå§‹å€¼"""
        å›å¤ = QMessageBox.question(
            self,
            "ç¡®è®¤é‡ç½®",
            "ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®åˆ°ä¸Šæ¬¡ä¿å­˜çš„çŠ¶æ€å—ï¼Ÿ",
            QMessageBox.Yes | QMessageBox.No,
            QMessageBox.No
        )
        
        if å›å¤ == QMessageBox.Yes:
            self._æ¢å¤åŸå§‹å€¼()
            self.é…ç½®å·²é‡ç½®.emit()
    
    def _æ¢å¤åŸå§‹å€¼(self):
        """ä»åŸå§‹å€¼æ¢å¤æ§ä»¶çŠ¶æ€"""
        if not self._åŸå§‹å€¼:
            return
        
        é…ç½® = self._åŸå§‹å€¼
        
        # æ¸¸æˆçª—å£
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å·¦"].setValue(é…ç½®.get("æ¸¸æˆçª—å£_å·¦", 0))
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸Š"].setValue(é…ç½®.get("æ¸¸æˆçª—å£_ä¸Š", 40))
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_å³"].setValue(é…ç½®.get("æ¸¸æˆçª—å£_å³", 1920))
        self._é…ç½®æ§ä»¶["æ¸¸æˆçª—å£_ä¸‹"].setValue(é…ç½®.get("æ¸¸æˆçª—å£_ä¸‹", 1120))
        self._é…ç½®æ§ä»¶["æ¸¸æˆå®½åº¦"].setValue(é…ç½®.get("æ¸¸æˆå®½åº¦", 1920))
        self._é…ç½®æ§ä»¶["æ¸¸æˆé«˜åº¦"].setValue(é…ç½®.get("æ¸¸æˆé«˜åº¦", 1080))
        
        # æ¨¡å‹
        self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥å®½åº¦"].setValue(é…ç½®.get("æ¨¡å‹è¾“å…¥å®½åº¦", 480))
        self._é…ç½®æ§ä»¶["æ¨¡å‹è¾“å…¥é«˜åº¦"].setValue(é…ç½®.get("æ¨¡å‹è¾“å…¥é«˜åº¦", 270))
        self._é…ç½®æ§ä»¶["æ¨¡å‹ä¿å­˜è·¯å¾„"].setText(é…ç½®.get("æ¨¡å‹ä¿å­˜è·¯å¾„", "æ¨¡å‹/æ¸¸æˆAI"))
        self._é…ç½®æ§ä»¶["é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„"].setText(é…ç½®.get("é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„", "æ¨¡å‹/é¢„è®­ç»ƒæ¨¡å‹/test"))
        
        # è®­ç»ƒ
        å­¦ä¹ ç‡ = é…ç½®.get("å­¦ä¹ ç‡", 0.001)
        self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡"].setValue(å­¦ä¹ ç‡)
        self._é…ç½®æ§ä»¶["å­¦ä¹ ç‡_æ»‘å—"].setValue(int(å­¦ä¹ ç‡ * 10000))
        self._é…ç½®æ§ä»¶["è®­ç»ƒè½®æ•°"].setValue(é…ç½®.get("è®­ç»ƒè½®æ•°", 10))
        self._é…ç½®æ§ä»¶["æ¯æ–‡ä»¶æ ·æœ¬æ•°"].setValue(é…ç½®.get("æ¯æ–‡ä»¶æ ·æœ¬æ•°", 500))
        self._é…ç½®æ§ä»¶["æ•°æ®ä¿å­˜è·¯å¾„"].setText(é…ç½®.get("æ•°æ®ä¿å­˜è·¯å¾„", "æ•°æ®/"))
        self._é…ç½®æ§ä»¶["è¿åŠ¨æ£€æµ‹é˜ˆå€¼"].setValue(é…ç½®.get("è¿åŠ¨æ£€æµ‹é˜ˆå€¼", 800))
        
        # å¢å¼ºæ¨¡å—
        self._é…ç½®æ§ä»¶["YOLOå¯ç”¨"].setChecked(é…ç½®.get("YOLOå¯ç”¨", True))
        self._é…ç½®æ§ä»¶["YOLOç½®ä¿¡åº¦"].setValue(int(é…ç½®.get("YOLOç½®ä¿¡åº¦", 0.5) * 100))
        self._é…ç½®æ§ä»¶["YOLOæ£€æµ‹é—´éš”"].setValue(é…ç½®.get("YOLOæ£€æµ‹é—´éš”", 3))
        self._é…ç½®æ§ä»¶["çŠ¶æ€è¯†åˆ«å¯ç”¨"].setChecked(é…ç½®.get("çŠ¶æ€è¯†åˆ«å¯ç”¨", True))
        self._é…ç½®æ§ä»¶["å†³ç­–å¼•æ“å¯ç”¨"].setChecked(é…ç½®.get("å†³ç­–å¼•æ“å¯ç”¨", True))
        self._é…ç½®æ§ä»¶["å†³ç­–ç­–ç•¥"].setCurrentIndex(é…ç½®.get("å†³ç­–ç­–ç•¥", 2))
        self._é…ç½®æ§ä»¶["è§„åˆ™æƒé‡"].setValue(int(é…ç½®.get("è§„åˆ™æƒé‡", 0.6) * 100))
        self._é…ç½®æ§ä»¶["è‡ªåŠ¨é™çº§"].setChecked(é…ç½®.get("è‡ªåŠ¨é™çº§", True))
        self._é…ç½®æ§ä»¶["å¸§ç‡é˜ˆå€¼"].setValue(é…ç½®.get("å¸§ç‡é˜ˆå€¼", 15))

    # ==================== é…ç½®æ–‡ä»¶ç”Ÿæˆæ–¹æ³• ====================
    
    def _ç”Ÿæˆè®¾ç½®æ–‡ä»¶å†…å®¹(self, é…ç½®: dict) -> str:
        """ç”Ÿæˆè®¾ç½®.pyæ–‡ä»¶å†…å®¹"""
        # è¯»å–åŸå§‹æ–‡ä»¶è·å–åŠ¨ä½œå®šä¹‰ç­‰ä¸å˜çš„éƒ¨åˆ†
        try:
            with open("é…ç½®/è®¾ç½®.py", "r", encoding="utf-8") as f:
                åŸå§‹å†…å®¹ = f.read()
        except:
            åŸå§‹å†…å®¹ = ""
        
        # æå–åŠ¨ä½œå®šä¹‰éƒ¨åˆ†ï¼ˆä» "# ==================== åŠ¨ä½œå®šä¹‰" å¼€å§‹åˆ°æ–‡ä»¶æœ«å°¾ï¼‰
        åŠ¨ä½œå®šä¹‰å¼€å§‹ = åŸå§‹å†…å®¹.find("# ==================== åŠ¨ä½œå®šä¹‰")
        if åŠ¨ä½œå®šä¹‰å¼€å§‹ > 0:
            åŠ¨ä½œå®šä¹‰éƒ¨åˆ† = åŸå§‹å†…å®¹[åŠ¨ä½œå®šä¹‰å¼€å§‹:]
        else:
            åŠ¨ä½œå®šä¹‰éƒ¨åˆ† = ""
        
        å†…å®¹ = f'''"""
å…¨å±€é…ç½®è®¾ç½®
"""

# ==================== æ¸¸æˆçª—å£è®¾ç½® ====================
# æ¸¸æˆçª—å£åŒºåŸŸ (å·¦, ä¸Š, å³, ä¸‹)
æ¸¸æˆçª—å£åŒºåŸŸ = ({é…ç½®["æ¸¸æˆçª—å£_å·¦"]}, {é…ç½®["æ¸¸æˆçª—å£_ä¸Š"]}, {é…ç½®["æ¸¸æˆçª—å£_å³"]}, {é…ç½®["æ¸¸æˆçª—å£_ä¸‹"]})

# æ¸¸æˆåˆ†è¾¨ç‡
æ¸¸æˆå®½åº¦ = {é…ç½®["æ¸¸æˆå®½åº¦"]}
æ¸¸æˆé«˜åº¦ = {é…ç½®["æ¸¸æˆé«˜åº¦"]}

# ==================== æ¨¡å‹è®¾ç½® ====================
# è¾“å…¥å›¾åƒå°ºå¯¸ (ç¼©æ”¾å)
æ¨¡å‹è¾“å…¥å®½åº¦ = {é…ç½®["æ¨¡å‹è¾“å…¥å®½åº¦"]}
æ¨¡å‹è¾“å…¥é«˜åº¦ = {é…ç½®["æ¨¡å‹è¾“å…¥é«˜åº¦"]}

# å­¦ä¹ ç‡
å­¦ä¹ ç‡ = {é…ç½®["å­¦ä¹ ç‡"]}

# è®­ç»ƒè½®æ•°
è®­ç»ƒè½®æ•° = {é…ç½®["è®­ç»ƒè½®æ•°"]}

# æ¨¡å‹ä¿å­˜è·¯å¾„
æ¨¡å‹ä¿å­˜è·¯å¾„ = "{é…ç½®["æ¨¡å‹ä¿å­˜è·¯å¾„"]}"

# é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„ (åŸé¡¹ç›®çš„æ¨¡å‹)
é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„ = "{é…ç½®["é¢„è®­ç»ƒæ¨¡å‹è·¯å¾„"]}"

# ==================== æ•°æ®æ”¶é›†è®¾ç½® ====================
# æ¯ä¸ªæ–‡ä»¶ä¿å­˜çš„æ ·æœ¬æ•°
æ¯æ–‡ä»¶æ ·æœ¬æ•° = {é…ç½®["æ¯æ–‡ä»¶æ ·æœ¬æ•°"]}

# æ•°æ®ä¿å­˜è·¯å¾„
æ•°æ®ä¿å­˜è·¯å¾„ = "{é…ç½®["æ•°æ®ä¿å­˜è·¯å¾„"]}"

# ==================== è¿åŠ¨æ£€æµ‹è®¾ç½® ====================
# è¿åŠ¨æ£€æµ‹é˜ˆå€¼ (ä½äºæ­¤å€¼è®¤ä¸ºå¡ä½)
è¿åŠ¨æ£€æµ‹é˜ˆå€¼ = {é…ç½®["è¿åŠ¨æ£€æµ‹é˜ˆå€¼"]}

# è¿åŠ¨æ£€æµ‹æ—¥å¿—é•¿åº¦
è¿åŠ¨æ—¥å¿—é•¿åº¦ = 25

'''
        
        # æ·»åŠ åŠ¨ä½œå®šä¹‰éƒ¨åˆ†
        if åŠ¨ä½œå®šä¹‰éƒ¨åˆ†:
            å†…å®¹ += åŠ¨ä½œå®šä¹‰éƒ¨åˆ†
        else:
            # å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŸå§‹åŠ¨ä½œå®šä¹‰ï¼Œä½¿ç”¨é»˜è®¤çš„
            å†…å®¹ += self._è·å–é»˜è®¤åŠ¨ä½œå®šä¹‰()
        
        return å†…å®¹
    
    def _è·å–é»˜è®¤åŠ¨ä½œå®šä¹‰(self) -> str:
        """è·å–é»˜è®¤çš„åŠ¨ä½œå®šä¹‰å†…å®¹"""
        return '''# ==================== åŠ¨ä½œå®šä¹‰ ====================
# å®Œæ•´åŠ¨ä½œåˆ—è¡¨ (32ä¸ªåŠ¨ä½œ)
åŠ¨ä½œå®šä¹‰ = {
    # ç§»åŠ¨åŠ¨ä½œ (0-8)
    0: {"åç§°": "å‰è¿›", "æŒ‰é”®": "W", "ç±»å‹": "ç§»åŠ¨"},
    1: {"åç§°": "åé€€", "æŒ‰é”®": "S", "ç±»å‹": "ç§»åŠ¨"},
    2: {"åç§°": "å·¦ç§»", "æŒ‰é”®": "A", "ç±»å‹": "ç§»åŠ¨"},
    3: {"åç§°": "å³ç§»", "æŒ‰é”®": "D", "ç±»å‹": "ç§»åŠ¨"},
    4: {"åç§°": "å‰è¿›+å·¦ç§»", "æŒ‰é”®": "W+A", "ç±»å‹": "ç§»åŠ¨"},
    5: {"åç§°": "å‰è¿›+å³ç§»", "æŒ‰é”®": "W+D", "ç±»å‹": "ç§»åŠ¨"},
    6: {"åç§°": "åé€€+å·¦ç§»", "æŒ‰é”®": "S+A", "ç±»å‹": "ç§»åŠ¨"},
    7: {"åç§°": "åé€€+å³ç§»", "æŒ‰é”®": "S+D", "ç±»å‹": "ç§»åŠ¨"},
    8: {"åç§°": "æ— æ“ä½œ", "æŒ‰é”®": "æ— ", "ç±»å‹": "ç§»åŠ¨"},
    
    # æŠ€èƒ½åŠ¨ä½œ (9-18)
    9: {"åç§°": "æŠ€èƒ½1", "æŒ‰é”®": "1", "ç±»å‹": "æŠ€èƒ½"},
    10: {"åç§°": "æŠ€èƒ½2", "æŒ‰é”®": "2", "ç±»å‹": "æŠ€èƒ½"},
    11: {"åç§°": "æŠ€èƒ½3", "æŒ‰é”®": "3", "ç±»å‹": "æŠ€èƒ½"},
    12: {"åç§°": "æŠ€èƒ½4", "æŒ‰é”®": "4", "ç±»å‹": "æŠ€èƒ½"},
    13: {"åç§°": "æŠ€èƒ½5", "æŒ‰é”®": "5", "ç±»å‹": "æŠ€èƒ½"},
    14: {"åç§°": "æŠ€èƒ½6", "æŒ‰é”®": "6", "ç±»å‹": "æŠ€èƒ½"},
    15: {"åç§°": "æŠ€èƒ½Q", "æŒ‰é”®": "Q", "ç±»å‹": "æŠ€èƒ½"},
    16: {"åç§°": "æŠ€èƒ½E", "æŒ‰é”®": "E", "ç±»å‹": "æŠ€èƒ½"},
    17: {"åç§°": "æŠ€èƒ½R", "æŒ‰é”®": "R", "ç±»å‹": "æŠ€èƒ½"},
    18: {"åç§°": "æŠ€èƒ½F", "æŒ‰é”®": "F", "ç±»å‹": "æŠ€èƒ½"},
    
    # ç‰¹æ®ŠåŠ¨ä½œ (19-23)
    19: {"åç§°": "è·³è·ƒ/é—ªé¿", "æŒ‰é”®": "ç©ºæ ¼", "ç±»å‹": "ç‰¹æ®Š"},
    20: {"åç§°": "åˆ‡æ¢ç›®æ ‡", "æŒ‰é”®": "Tab", "ç±»å‹": "ç‰¹æ®Š"},
    21: {"åç§°": "äº¤äº’", "æŒ‰é”®": "F", "ç±»å‹": "ç‰¹æ®Š"},
    
    # é¼ æ ‡åŠ¨ä½œ (22-24)
    22: {"åç§°": "é¼ æ ‡å·¦é”®", "æŒ‰é”®": "é¼ æ ‡å·¦", "ç±»å‹": "é¼ æ ‡"},
    23: {"åç§°": "é¼ æ ‡å³é”®", "æŒ‰é”®": "é¼ æ ‡å³", "ç±»å‹": "é¼ æ ‡"},
    24: {"åç§°": "é¼ æ ‡ä¸­é”®", "æŒ‰é”®": "é¼ æ ‡ä¸­", "ç±»å‹": "é¼ æ ‡"},
    
    # Shiftç»„åˆæŠ€èƒ½ (25-28)
    25: {"åç§°": "Shift+1", "æŒ‰é”®": "Shift+1", "ç±»å‹": "ç»„åˆ"},
    26: {"åç§°": "Shift+2", "æŒ‰é”®": "Shift+2", "ç±»å‹": "ç»„åˆ"},
    27: {"åç§°": "Shift+Q", "æŒ‰é”®": "Shift+Q", "ç±»å‹": "ç»„åˆ"},
    28: {"åç§°": "Shift+E", "æŒ‰é”®": "Shift+E", "ç±»å‹": "ç»„åˆ"},
    
    # Ctrlç»„åˆæŠ€èƒ½ (29-31)
    29: {"åç§°": "Ctrl+1", "æŒ‰é”®": "Ctrl+1", "ç±»å‹": "ç»„åˆ"},
    30: {"åç§°": "Ctrl+2", "æŒ‰é”®": "Ctrl+2", "ç±»å‹": "ç»„åˆ"},
    31: {"åç§°": "Ctrl+Q", "æŒ‰é”®": "Ctrl+Q", "ç±»å‹": "ç»„åˆ"},
}

# æ€»åŠ¨ä½œæ•°
æ€»åŠ¨ä½œæ•° = len(åŠ¨ä½œå®šä¹‰)

# ==================== è®­ç»ƒæ¨¡å¼è®¾ç½® ====================
class è®­ç»ƒæ¨¡å¼:
    """è®­ç»ƒæ¨¡å¼é…ç½®"""
    
    # ä¸»çº¿ä»»åŠ¡æ¨¡å¼ - ä¾§é‡ç§»åŠ¨å’Œäº¤äº’
    ä¸»çº¿ä»»åŠ¡ = {
        "åç§°": "ä¸»çº¿ä»»åŠ¡ç»ƒçº§",
        "æè¿°": "å­¦ä¹ åšä¸»çº¿ä»»åŠ¡çš„æ“ä½œä¹ æƒ¯",
        "å¯ç”¨åŠ¨ä½œ": list(range(9)) + [21, 22, 23],
        "åŠ¨ä½œæƒé‡": [
            4.0, 0.5, 0.5, 0.5, 2.0, 2.0, 0.5, 0.5, 0.2,
            0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1,
            0.5, 0.3, 1.0,
            1.5, 1.5, 0.1,
            0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1,
        ],
    }
    
    # è‡ªåŠ¨æˆ˜æ–—æ¨¡å¼ - ä¾§é‡æŠ€èƒ½å’Œèµ°ä½
    è‡ªåŠ¨æˆ˜æ–— = {
        "åç§°": "è‡ªåŠ¨æˆ˜æ–—",
        "æè¿°": "å­¦ä¹ æˆ˜æ–—æŠ€èƒ½é‡Šæ”¾å’Œèµ°ä½",
        "å¯ç”¨åŠ¨ä½œ": list(range(32)),
        "åŠ¨ä½œæƒé‡": [
            2.0, 0.5, 1.0, 1.0, 1.5, 1.5, 0.5, 0.5, 0.1,
            2.0, 2.0, 2.0, 2.0, 1.5, 1.5, 2.0, 2.0, 1.5, 1.5,
            2.0, 1.5, 1.0,
            2.5, 2.0, 0.5,
            1.5, 1.5, 1.5, 1.5, 1.0, 1.0, 1.0,
        ],
    }

# ==================== æŒ‰é”®æ‰«æç  ====================
æŒ‰é”®ç  = {
    "W": 0x11, "A": 0x1E, "S": 0x1F, "D": 0x20,
    "Q": 0x10, "E": 0x12, "R": 0x13, "F": 0x21,
    "1": 0x02, "2": 0x03, "3": 0x04, "4": 0x05,
    "5": 0x06, "6": 0x07, "7": 0x08, "8": 0x09,
    "9": 0x0A, "0": 0x0B,
    "ç©ºæ ¼": 0x39, "Tab": 0x0F,
    "Shift": 0x2A, "Ctrl": 0x1D, "Alt": 0x38,
}
'''

    def _ç”Ÿæˆå¢å¼ºè®¾ç½®æ–‡ä»¶å†…å®¹(self, é…ç½®: dict) -> str:
        """ç”Ÿæˆå¢å¼ºè®¾ç½®.pyæ–‡ä»¶å†…å®¹"""
        # å†³ç­–ç­–ç•¥æ˜ å°„
        ç­–ç•¥åç§° = ["è§„åˆ™ä¼˜å…ˆ", "æ¨¡å‹ä¼˜å…ˆ", "æ··åˆåŠ æƒ"][é…ç½®["å†³ç­–ç­–ç•¥"]]
        ç­–ç•¥æšä¸¾ = f"å†³ç­–ç­–ç•¥æšä¸¾.{ç­–ç•¥åç§°}"
        
        å†…å®¹ = f'''"""
å¢å¼ºæ¨¡å—é…ç½®è®¾ç½®
å®šä¹‰YOLOæ£€æµ‹å™¨ã€çŠ¶æ€è¯†åˆ«å™¨ã€å†³ç­–å¼•æ“çš„é…ç½®é¡¹
"""

from enum import Enum

# ==================== å®ä½“ç±»å‹æšä¸¾ ====================
class å®ä½“ç±»å‹æšä¸¾(Enum):
    """æ¸¸æˆä¸­å¯è¯†åˆ«çš„å®ä½“ç±»å‹"""
    æ€ªç‰© = "monster"
    NPC = "npc"
    ç©å®¶ = "player"
    ç‰©å“ = "item"
    æŠ€èƒ½ç‰¹æ•ˆ = "skill_effect"
    æœªçŸ¥ = "unknown"


# ==================== æ¸¸æˆçŠ¶æ€æšä¸¾ ====================
class æ¸¸æˆçŠ¶æ€æšä¸¾(Enum):
    """æ¸¸æˆçŠ¶æ€æšä¸¾"""
    æˆ˜æ–— = "combat"
    å¯¹è¯ = "dialogue"
    èœå• = "menu"
    ç§»åŠ¨ = "moving"
    æ‹¾å– = "looting"
    é‡‡é›† = "gathering"
    æ­»äº¡ = "dead"
    åŠ è½½ = "loading"
    ç©ºé—² = "idle"
    æœªçŸ¥ = "unknown"


# ==================== YOLOæ£€æµ‹å™¨è®¾ç½® ====================
YOLOé…ç½® = {{
    "æ¨¡å‹è·¯å¾„": "æ¨¡å‹/yolo/game_detector.pt",
    "ç½®ä¿¡åº¦é˜ˆå€¼": {é…ç½®["YOLOç½®ä¿¡åº¦"]},
    "NMSé˜ˆå€¼": 0.4,
    "è¾“å…¥å°ºå¯¸": (640, 640),
    "å¯ç”¨": {é…ç½®["YOLOå¯ç”¨"]},
    "æ£€æµ‹é—´éš”": {é…ç½®["YOLOæ£€æµ‹é—´éš”"]},
}}

# å®ä½“ç±»å‹æ˜ å°„ (YOLOç±»åˆ«ID -> å®ä½“ç±»å‹)
å®ä½“ç±»å‹æ˜ å°„ = {{
    0: å®ä½“ç±»å‹æšä¸¾.æ€ªç‰©,
    1: å®ä½“ç±»å‹æšä¸¾.NPC,
    2: å®ä½“ç±»å‹æšä¸¾.ç©å®¶,
    3: å®ä½“ç±»å‹æšä¸¾.ç‰©å“,
    4: å®ä½“ç±»å‹æšä¸¾.æŠ€èƒ½ç‰¹æ•ˆ,
}}


# ==================== çŠ¶æ€è¯†åˆ«å™¨è®¾ç½® ====================
çŠ¶æ€è¯†åˆ«é…ç½® = {{
    "å†å²é•¿åº¦": 10,
    "ç½®ä¿¡åº¦ç´¯ç§¯ç³»æ•°": 0.1,
    "UIæ£€æµ‹å¯ç”¨": True,
    "å¯ç”¨": {é…ç½®["çŠ¶æ€è¯†åˆ«å¯ç”¨"]},
}}

# UIå…ƒç´ æ¨¡æ¿è·¯å¾„
UIæ¨¡æ¿è·¯å¾„ = {{
    "å¯¹è¯æ¡†": "èµ„æº/ui/dialogue_box.png",
    "èœå•": "èµ„æº/ui/menu.png",
    "è¡€æ¡": "èµ„æº/ui/health_bar.png",
    "æ­»äº¡ç•Œé¢": "èµ„æº/ui/death_screen.png",
    "åŠ è½½ç•Œé¢": "èµ„æº/ui/loading.png",
}}

# çŠ¶æ€åˆ¤å®šé˜ˆå€¼
çŠ¶æ€åˆ¤å®šé˜ˆå€¼ = {{
    "æˆ˜æ–—_æ•Œäººè·ç¦»": 200,
    "æˆ˜æ–—_æ•Œäººæ•°é‡": 1,
    "æ‹¾å–_ç‰©å“è·ç¦»": 100,
}}


# ==================== å†³ç­–å¼•æ“è®¾ç½® ====================
class å†³ç­–ç­–ç•¥æšä¸¾(Enum):
    """å†³ç­–ç­–ç•¥ç±»å‹"""
    è§„åˆ™ä¼˜å…ˆ = "rule_first"
    æ¨¡å‹ä¼˜å…ˆ = "model_first"
    æ··åˆåŠ æƒ = "weighted_mix"


å†³ç­–å¼•æ“é…ç½® = {{
    "ç­–ç•¥": {ç­–ç•¥æšä¸¾},
    "è§„åˆ™æƒé‡": {é…ç½®["è§„åˆ™æƒé‡"]},
    "æ¨¡å‹æƒé‡": {1 - é…ç½®["è§„åˆ™æƒé‡"]:.2f},
    "å¯ç”¨æ—¥å¿—": True,
    "æ—¥å¿—é•¿åº¦": 100,
    "å¯ç”¨": {é…ç½®["å†³ç­–å¼•æ“å¯ç”¨"]},
}}

# çŠ¶æ€-åŠ¨ä½œæƒé‡æ˜ å°„
çŠ¶æ€åŠ¨ä½œæƒé‡ = {{
    æ¸¸æˆçŠ¶æ€æšä¸¾.æˆ˜æ–—: {{
        "ç§»åŠ¨": 1.5,
        "æŠ€èƒ½": 2.5,
        "ç‰¹æ®Š": 2.0,
        "é¼ æ ‡": 2.0,
        "ç»„åˆ": 1.5,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.å¯¹è¯: {{
        "ç§»åŠ¨": 0.1,
        "æŠ€èƒ½": 0.0,
        "ç‰¹æ®Š": 0.5,
        "é¼ æ ‡": 2.5,
        "ç»„åˆ": 0.0,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.èœå•: {{
        "ç§»åŠ¨": 0.0,
        "æŠ€èƒ½": 0.0,
        "ç‰¹æ®Š": 0.3,
        "é¼ æ ‡": 3.0,
        "ç»„åˆ": 0.0,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.ç§»åŠ¨: {{
        "ç§»åŠ¨": 3.0,
        "æŠ€èƒ½": 0.2,
        "ç‰¹æ®Š": 0.5,
        "é¼ æ ‡": 1.0,
        "ç»„åˆ": 0.1,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.æ‹¾å–: {{
        "ç§»åŠ¨": 1.0,
        "æŠ€èƒ½": 0.0,
        "ç‰¹æ®Š": 1.0,
        "é¼ æ ‡": 2.0,
        "ç»„åˆ": 0.0,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.é‡‡é›†: {{
        "ç§»åŠ¨": 0.1,
        "æŠ€èƒ½": 0.0,
        "ç‰¹æ®Š": 0.3,
        "é¼ æ ‡": 1.5,
        "ç»„åˆ": 0.0,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.æ­»äº¡: {{
        "ç§»åŠ¨": 0.0,
        "æŠ€èƒ½": 0.0,
        "ç‰¹æ®Š": 0.5,
        "é¼ æ ‡": 2.0,
        "ç»„åˆ": 0.0,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.åŠ è½½: {{
        "ç§»åŠ¨": 0.0,
        "æŠ€èƒ½": 0.0,
        "ç‰¹æ®Š": 0.0,
        "é¼ æ ‡": 0.0,
        "ç»„åˆ": 0.0,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.ç©ºé—²: {{
        "ç§»åŠ¨": 1.0,
        "æŠ€èƒ½": 0.5,
        "ç‰¹æ®Š": 1.0,
        "é¼ æ ‡": 1.5,
        "ç»„åˆ": 0.5,
    }},
    æ¸¸æˆçŠ¶æ€æšä¸¾.æœªçŸ¥: {{
        "ç§»åŠ¨": 1.0,
        "æŠ€èƒ½": 0.5,
        "ç‰¹æ®Š": 0.5,
        "é¼ æ ‡": 1.0,
        "ç»„åˆ": 0.5,
    }},
}}

# åŠ¨ä½œå†·å´æ—¶é—´ (ç§’)
åŠ¨ä½œå†·å´æ—¶é—´ = {{
    9: 1.0,
    10: 1.5,
    11: 2.0,
    12: 2.5,
    13: 3.0,
    14: 3.0,
    15: 1.0,
    16: 1.0,
    17: 2.0,
    18: 2.0,
    19: 0.5,
    20: 1.0,
}}

# ç´§æ€¥è§„åˆ™é…ç½®
ç´§æ€¥è§„åˆ™é…ç½® = {{
    "ä½è¡€é‡é˜ˆå€¼": 0.3,
    "è¢«å›´æ”»é˜ˆå€¼": 3,
    "ç´§æ€¥åŠ¨ä½œ": 19,
}}


# ==================== æ¨¡å—å¯ç”¨é…ç½® ====================
æ¨¡å—å¯ç”¨é…ç½® = {{
    "YOLOæ£€æµ‹å™¨": {é…ç½®["YOLOå¯ç”¨"]},
    "çŠ¶æ€è¯†åˆ«å™¨": {é…ç½®["çŠ¶æ€è¯†åˆ«å¯ç”¨"]},
    "å†³ç­–å¼•æ“": {é…ç½®["å†³ç­–å¼•æ“å¯ç”¨"]},
}}

# ==================== æ€§èƒ½é…ç½® ====================
æ€§èƒ½é…ç½® = {{
    "ä½æ€§èƒ½æ¨¡å¼æ£€æµ‹é—´éš”": 5,
    "å¸§ç‡é˜ˆå€¼": {é…ç½®["å¸§ç‡é˜ˆå€¼"]},
    "è‡ªåŠ¨é™çº§": {é…ç½®["è‡ªåŠ¨é™çº§"]},
}}
'''
        return å†…å®¹
